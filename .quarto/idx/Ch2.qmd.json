{"title":"Intuition for models for intensities","markdown":{"headingText":"Intuition for models for intensities","containsRefs":false,"markdown":"\n```{r, echo=FALSE, cache=TRUE}\nsource(\"_common.R\")\nlibrary(survival)\n```\n\n$$\\alpha(t)=\\alpha_0(t)\\exp(\\beta Z)$$\n\n<!-- ## Hazard models for homogeneous groups {#homogeneous-groups} -->\n\n## Figure 2.2 {#fig2-2 .unnumbered}\n\n```{r}\npbc3<-readRDS(\"data/pbc3.rds\")\nlibrary(survival)\nrequire(tidyverse)\nnafit <- survfit(Surv(followup, status != 0) ~ tment, data = pbc3)\nnadata <- data.frame(cumhaz = nafit$cumhaz, \n                     cumhaz_se = nafit$std.err, \n                     time = nafit$time, \n                     tment = c(rep(names(nafit$strata)[1], nafit$strata[1]), \n                               rep(names(nafit$strata)[2], nafit$strata[2])))\n\n# Create Figure 2.2\nggplot(aes(x = time, y = cumhaz, linetype = tment), data = nadata) + \n          geom_step(size = 1) + \n          scale_linetype_discrete(\"Treatment\", labels = c(\"Placebo\", \"CyA\")) + \n          xlab(\"Time since randomization (years)\") + \n          ylab(\"Cumulative hazard\") + \n          scale_x_continuous(expand = expansion(mult = c(0.005, 0.05)), ) + \n          scale_y_continuous(expand = expansion(mult = c(0.005, 0.05))) +\n          theme_general\n\n```\n\n<!-- ### Piece-wise constant hazards -->\n\n## Figure 2.3 {#fig2-3 .unnumbered}\n\n```{r, file = \"R/2/pcwplot.r\"}\n```\n\n## Cox model {#cox-models .unnumbered}\n\n```{r sas-datastep, eval=FALSE, echo=TRUE}\nlibname h \"data\";\ndata pbc3;\n  set h.pbc3;\n  event=status ne 0; * Binary variable for events for later use;\nrun;\nproc phreg data=pbc3;\n  class tment(ref=\"0\") / param=ref;\n  model years*status(0)=tment;\nrun;\n```\n\n```{sas, engine.path=saspath, echo=FALSE, cache=TRUE}\nlibname h \"data\";\ndata pbc3;\n  set h.pbc3;\n  event=status ne 0; * Binary variable for events for later use;\nrun;\nproc phreg data=pbc3;\n  class tment(ref=\"0\") / param=ref;\n  model years*status(0)=tment;\nrun;\n```\n\n## Exercises\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Ch2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","editor":"source","theme":["cosmo","msb.scss"]},"extensions":{"book":{"multiFile":true}}}}}