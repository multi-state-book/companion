<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Models for Multi-State Survival Data - 3&nbsp; Intensity models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch4.html" rel="next">
<link href="./Ch2.html" rel="prev">
<link href="./corvos.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intensity models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./MSBfrontbirds.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Models for Multi-State Survival Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/multi-state-book/companion" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and data sets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intuition for intensity models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intensity models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intuition for marginal models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Marginal models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pseudo-values</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Further topics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./errata.html" class="sidebar-item-text sidebar-link">Errata</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pbc3-trial-in-liver-cirrhosis" id="toc-pbc3-trial-in-liver-cirrhosis" class="nav-link active" data-scroll-target="#pbc3-trial-in-liver-cirrhosis">PBC3 trial in liver cirrhosis</a>
  <ul>
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data">Read data</a></li>
  <li><a href="#table-3.11" id="toc-table-3.11" class="nav-link" data-scroll-target="#table-3.11">Table 3.11</a></li>
  </ul></li>
  <li><a href="#guinea-bissau-childhood-vaccination-study" id="toc-guinea-bissau-childhood-vaccination-study" class="nav-link" data-scroll-target="#guinea-bissau-childhood-vaccination-study">Guinea-Bissau childhood vaccination study</a>
  <ul>
  <li><a href="#read-data-1" id="toc-read-data-1" class="nav-link" data-scroll-target="#read-data-1">Read data</a></li>
  <li><a href="#table-3.1" id="toc-table-3.1" class="nav-link" data-scroll-target="#table-3.1">Table 3.1</a></li>
  <li><a href="#table-3.2" id="toc-table-3.2" class="nav-link" data-scroll-target="#table-3.2">Table 3.2</a></li>
  </ul></li>
  <li><a href="#testis-cancer-incidence-and-maternal-parity" id="toc-testis-cancer-incidence-and-maternal-parity" class="nav-link" data-scroll-target="#testis-cancer-incidence-and-maternal-parity">Testis cancer incidence and maternal parity</a>
  <ul>
  <li><a href="#read-data-2" id="toc-read-data-2" class="nav-link" data-scroll-target="#read-data-2">Read data</a></li>
  <li><a href="#figure-3.1" id="toc-figure-3.1" class="nav-link" data-scroll-target="#figure-3.1">Figure 3.1</a></li>
  <li><a href="#table-3.5" id="toc-table-3.5" class="nav-link" data-scroll-target="#table-3.5">Table 3.5</a></li>
  </ul></li>
  <li><a href="#prova-trial-in-liver-cirrhosis" id="toc-prova-trial-in-liver-cirrhosis" class="nav-link" data-scroll-target="#prova-trial-in-liver-cirrhosis">PROVA trial in liver cirrhosis</a>
  <ul>
  <li><a href="#read-data-3" id="toc-read-data-3" class="nav-link" data-scroll-target="#read-data-3">Read data</a></li>
  <li><a href="#table-3.3" id="toc-table-3.3" class="nav-link" data-scroll-target="#table-3.3">Table 3.3</a></li>
  <li><a href="#table-3.4" id="toc-table-3.4" class="nav-link" data-scroll-target="#table-3.4">Table 3.4</a></li>
  <li><a href="#table-3.8" id="toc-table-3.8" class="nav-link" data-scroll-target="#table-3.8">Table 3.8</a></li>
  <li><a href="#figure-3.2" id="toc-figure-3.2" class="nav-link" data-scroll-target="#figure-3.2">Figure 3.2</a></li>
  <li><a href="#figure-3.3" id="toc-figure-3.3" class="nav-link" data-scroll-target="#figure-3.3">Figure 3.3</a></li>
  <li><a href="#table-3.9" id="toc-table-3.9" class="nav-link" data-scroll-target="#table-3.9">Table 3.9</a></li>
  <li><a href="#table-3.10" id="toc-table-3.10" class="nav-link" data-scroll-target="#table-3.10">Table 3.10</a></li>
  <li><a href="#table-3.13" id="toc-table-3.13" class="nav-link" data-scroll-target="#table-3.13">Table 3.13</a></li>
  <li><a href="#figure-3.9" id="toc-figure-3.9" class="nav-link" data-scroll-target="#figure-3.9">Figure 3.9</a></li>
  </ul></li>
  <li><a href="#recurrent-episodes-in-affective-disorders" id="toc-recurrent-episodes-in-affective-disorders" class="nav-link" data-scroll-target="#recurrent-episodes-in-affective-disorders">Recurrent episodes in affective disorders</a>
  <ul>
  <li><a href="#read-data-4" id="toc-read-data-4" class="nav-link" data-scroll-target="#read-data-4">Read data</a></li>
  <li><a href="#table-3.6" id="toc-table-3.6" class="nav-link" data-scroll-target="#table-3.6">Table 3.6</a></li>
  <li><a href="#table-3.7" id="toc-table-3.7" class="nav-link" data-scroll-target="#table-3.7">Table 3.7</a></li>
  </ul></li>
  <li><a href="#leader-cardiovascular-trial-in-type-2-diabetes" id="toc-leader-cardiovascular-trial-in-type-2-diabetes" class="nav-link" data-scroll-target="#leader-cardiovascular-trial-in-type-2-diabetes">LEADER cardiovascular trial in type 2 diabetes</a>
  <ul>
  <li><a href="#read-data-5" id="toc-read-data-5" class="nav-link" data-scroll-target="#read-data-5">Read data</a></li>
  <li><a href="#table-3.15" id="toc-table-3.15" class="nav-link" data-scroll-target="#table-3.15">Table 3.15</a></li>
  </ul></li>
  <li><a href="#bone-marrow-transplantation-in-acute-leukemia" id="toc-bone-marrow-transplantation-in-acute-leukemia" class="nav-link" data-scroll-target="#bone-marrow-transplantation-in-acute-leukemia">Bone marrow transplantation in acute leukemia</a>
  <ul>
  <li><a href="#read-data-6" id="toc-read-data-6" class="nav-link" data-scroll-target="#read-data-6">Read data</a></li>
  <li><a href="#figure-3.5" id="toc-figure-3.5" class="nav-link" data-scroll-target="#figure-3.5">Figure 3.5</a></li>
  <li><a href="#figure-3.6" id="toc-figure-3.6" class="nav-link" data-scroll-target="#figure-3.6">Figure 3.6</a></li>
  <li><a href="#figure-3.7" id="toc-figure-3.7" class="nav-link" data-scroll-target="#figure-3.7">Figure 3.7</a></li>
  <li><a href="#in-text-gvhd-as-time-dependent-covariate" id="toc-in-text-gvhd-as-time-dependent-covariate" class="nav-link" data-scroll-target="#in-text-gvhd-as-time-dependent-covariate">In-text: GvHD as time-dependent covariate</a>
  <ul>
  <li><a href="#relapse" id="toc-relapse" class="nav-link" data-scroll-target="#relapse">Relapse</a></li>
  <li><a href="#death-in-remission" id="toc-death-in-remission" class="nav-link" data-scroll-target="#death-in-remission">Death in remission</a></li>
  </ul></li>
  <li><a href="#figure-3.8" id="toc-figure-3.8" class="nav-link" data-scroll-target="#figure-3.8">Figure 3.8</a></li>
  <li><a href="#figure-3.4" id="toc-figure-3.4" class="nav-link" data-scroll-target="#figure-3.4">Figure 3.4</a></li>
  <li><a href="#table-3.12" id="toc-table-3.12" class="nav-link" data-scroll-target="#table-3.12">Table 3.12</a></li>
  <li><a href="#table-3.14" id="toc-table-3.14" class="nav-link" data-scroll-target="#table-3.14">Table 3.14</a></li>
  <li><a href="#figure-3.10" id="toc-figure-3.10" class="nav-link" data-scroll-target="#figure-3.10">Figure 3.10</a></li>
  <li><a href="#table-3.15-1" id="toc-table-3.15-1" class="nav-link" data-scroll-target="#table-3.15-1">Table 3.15</a></li>
  <li><a href="#in-text-stratified-cox-model-by-center" id="toc-in-text-stratified-cox-model-by-center" class="nav-link" data-scroll-target="#in-text-stratified-cox-model-by-center">In-text: stratified Cox model by center</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/multi-state-book/companion/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intensity models</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Show/hide all code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pbc3-trial-in-liver-cirrhosis" class="level2">
<h2 class="anchored" data-anchor-id="pbc3-trial-in-liver-cirrhosis">PBC3 trial in liver cirrhosis</h2>
<section id="read-data" class="level3">
<h3 class="anchored" data-anchor-id="read-data">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-pbc3_482837a36b5e1f7842db442011126406">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pbc3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/pbc3.csv"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pbc3<span class="sc">$</span>log2bili <span class="ot">&lt;-</span> <span class="fu">with</span>(pbc3, <span class="fu">log2</span>(bili))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pbc3<span class="sc">$</span>years <span class="ot">&lt;-</span> <span class="fu">with</span>(pbc3, days<span class="sc">/</span><span class="fl">365.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-pbc3-sas_6c7c1053c1a8d30f169fc1ca1da851ad">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>proc import out<span class="ot">=</span>pbc3</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/pbc3.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    dbms<span class="ot">=</span>csv replace;</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data pbc3; </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    set pbc3;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    log2bili<span class="ot">=</span><span class="fu">log2</span>(bili);</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.11" class="level3">
<h3 class="anchored" data-anchor-id="table-3.11">Table 3.11</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.11-r_c1a83a2da53c94d824a0807ad30790e1">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(tment), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) (x<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>t, <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(tment), data = pbc3, tt = function(x, t, ...) (x == 1) * 
    t, method = "breslow")

              coef exp(coef) se(coef)      z        p
tment     -0.65937   0.51718  0.40576 -1.625    0.104
alb       -0.09136   0.91269  0.02167 -4.216 2.49e-05
log2bili   0.66299   1.94059  0.07478  8.866  &lt; 2e-16
tt(tment)  0.04497   1.04600  0.17811  0.253    0.801

Likelihood ratio test=120.1  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(tment), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) (x<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(t), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(tment), data = pbc3, tt = function(x, t, ...) (x == 1) * 
    log(t), method = "breslow")

              coef exp(coef) se(coef)      z        p
tment     -0.61330   0.54156  0.24327 -2.521   0.0117
alb       -0.09152   0.91254  0.02163 -4.232 2.32e-05
log2bili   0.66214   1.93894  0.07462  8.873  &lt; 2e-16
tt(tment)  0.10834   1.11442  0.25424  0.426   0.6700

Likelihood ratio test=120.2  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(tment), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) (x<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(t<span class="sc">&gt;</span><span class="dv">2</span>), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(tment), data = pbc3, tt = function(x, t, ...) (x == 1) * 
    (t &gt; 2), method = "breslow")

              coef exp(coef) se(coef)      z        p
tment     -0.58773   0.55559  0.29228 -2.011   0.0443
alb       -0.09104   0.91298  0.02168 -4.199 2.68e-05
log2bili   0.66456   1.94363  0.07466  8.901  &lt; 2e-16
tt(tment)  0.03169   1.03220  0.43384  0.073   0.9418

Likelihood ratio test=120  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Albumin </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(alb), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) x<span class="sc">*</span>t, <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(alb), data = pbc3, tt = function(x, t, ...) x * t, method = "breslow")

             coef exp(coef) se(coef)      z        p
tment    -0.59080   0.55389  0.22472 -2.629 0.008562
alb      -0.13296   0.87550  0.03998 -3.326 0.000882
log2bili  0.66405   1.94265  0.07476  8.882  &lt; 2e-16
tt(alb)   0.02317   1.02344  0.01854  1.250 0.211400

Likelihood ratio test=121.6  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(alb), </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) x<span class="sc">*</span><span class="fu">log</span>(t), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(alb), data = pbc3, tt = function(x, t, ...) x * log(t), 
    method = "breslow")

             coef exp(coef) se(coef)      z        p
tment    -0.58958   0.55456  0.22460 -2.625  0.00867
alb      -0.10194   0.90308  0.02349 -4.341 1.42e-05
log2bili  0.66488   1.94425  0.07483  8.885  &lt; 2e-16
tt(alb)   0.03347   1.03404  0.02561  1.307  0.19120

Likelihood ratio test=121.8  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(alb), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3,  <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) (x)<span class="sc">*</span>(t<span class="sc">&gt;</span><span class="dv">2</span>), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(alb), data = pbc3, tt = function(x, t, ...) (x) * (t &gt; 
    2), method = "breslow")

             coef exp(coef) se(coef)      z       p
tment    -0.59037   0.55412  0.22472 -2.627 0.00861
alb      -0.11369   0.89254  0.02779 -4.091 4.3e-05
log2bili  0.66488   1.94426  0.07470  8.901 &lt; 2e-16
tt(alb)   0.05674   1.05838  0.04330  1.310 0.19005

Likelihood ratio test=121.8  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2 bilirubin</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(log2bili), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) x<span class="sc">*</span>t, <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(log2bili), data = pbc3, tt = function(x, t, ...) x * t, 
    method = "breslow")

                 coef exp(coef) se(coef)      z        p
tment        -0.54631   0.57908  0.22571 -2.420   0.0155
alb          -0.09009   0.91385  0.02173 -4.147 3.37e-05
log2bili      0.77736   2.17571  0.13382  5.809 6.28e-09
tt(log2bili) -0.06299   0.93895  0.06181 -1.019   0.3081

Likelihood ratio test=121.1  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(log2bili), </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3, <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) x<span class="sc">*</span><span class="fu">log</span>(t), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(log2bili), data = pbc3, tt = function(x, t, ...) x * log(t), 
    method = "breslow")

                 coef exp(coef) se(coef)      z        p
tment        -0.55398   0.57466  0.22536 -2.458    0.014
alb          -0.09050   0.91347  0.02170 -4.170 3.04e-05
log2bili      0.68779   1.98931  0.07968  8.632  &lt; 2e-16
tt(log2bili) -0.07701   0.92588  0.08780 -0.877    0.380

Likelihood ratio test=120.8  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(years, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> tment <span class="sc">+</span> alb <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">tt</span>(log2bili), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> pbc3,  <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...) (x)<span class="sc">*</span>(t<span class="sc">&gt;</span><span class="dv">2</span>), <span class="at">method =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(years, status != 0) ~ tment + alb + log2bili + 
    tt(log2bili), data = pbc3, tt = function(x, t, ...) (x) * 
    (t &gt; 2), method = "breslow")

                 coef exp(coef) se(coef)      z        p
tment        -0.54878   0.57765  0.22521 -2.437   0.0148
alb          -0.09045   0.91352  0.02176 -4.157 3.22e-05
log2bili      0.73519   2.08587  0.09487  7.750 9.22e-15
tt(log2bili) -0.18232   0.83334  0.14910 -1.223   0.2214

Likelihood ratio test=121.5  on 4 df, p=&lt; 2.2e-16
n= 343, number of events= 88 
   (6 observations deleted due to missingness)</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.11-sas_64eb94f1139ac7a81f09575274b3597a">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Treatment; </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili tmenttime<span class="sc">/</span>rl;</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    tmenttime<span class="ot">=</span>(<span class="at">tment=</span><span class="dv">1</span>)<span class="sc">*</span>days;</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili tmentlogtime<span class="sc">/</span>rl;</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    tmentlogtime<span class="ot">=</span>(<span class="at">tment=</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(days);</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili tmentt0<span class="sc">/</span>rl;</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    tmentt0<span class="ot">=</span>(<span class="at">tment=</span><span class="dv">1</span>)<span class="sc">*</span>(days<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>);</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Log bilirubin;</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili bilitime<span class="sc">/</span>rl;</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    bilitime<span class="ot">=</span>log2bili<span class="sc">*</span>days;</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili bililogtime<span class="sc">/</span>rl;</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    bililogtime<span class="ot">=</span>log2bili<span class="sc">*</span><span class="fu">log</span>(days);</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili bilit0<span class="sc">/</span>rl;</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    bilit0<span class="ot">=</span>log2bili<span class="sc">*</span>(days<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>);</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Albumin; </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili albtime<span class="sc">/</span>rl;</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    albtime<span class="ot">=</span>alb<span class="sc">*</span>days;</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili alblogtime<span class="sc">/</span>rl;</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    alblogtime<span class="ot">=</span>alb<span class="sc">*</span><span class="fu">log</span>(days);</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>pbc3;</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">tment</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    model days<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>tment alb log2bili albt0<span class="sc">/</span>rl;</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    albt0<span class="ot">=</span>alb<span class="sc">*</span>(days<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>);</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="guinea-bissau-childhood-vaccination-study" class="level2">
<h2 class="anchored" data-anchor-id="guinea-bissau-childhood-vaccination-study">Guinea-Bissau childhood vaccination study</h2>
<section id="read-data-1" class="level3">
<h3 class="anchored" data-anchor-id="read-data-1">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-bissau_4704984d65e903bedb6db66572bbbd00">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bissau <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/bissau.csv"</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables for age as time scale and dtp binary</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>bissau<span class="sc">$</span>agein  <span class="ot">&lt;-</span> <span class="fu">with</span>(bissau, age<span class="sc">/</span>(<span class="fl">365.24</span><span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>bissau<span class="sc">$</span>ageout <span class="ot">&lt;-</span> <span class="fu">with</span>(bissau, agein<span class="sc">+</span>fuptime<span class="sc">/</span>(<span class="fl">365.24</span><span class="sc">/</span><span class="dv">12</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>bissau<span class="sc">$</span>dtpany <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">with</span>(bissau, dtp<span class="sc">&gt;</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-bissau-sas_32096a6c07107e5acda3d892c8f91d74">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>proc import </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/bissau.csv"</span> out<span class="ot">=</span>bissau</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    dbms <span class="ot">=</span> csv replace;</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>data bissau; </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    set bissau;</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    agein<span class="ot">=</span>age<span class="sc">/</span>(<span class="fl">365.24</span><span class="sc">/</span><span class="dv">12</span>);</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ageout<span class="ot">=</span>agein<span class="sc">+</span>fuptime<span class="sc">/</span>(<span class="fl">365.24</span><span class="sc">/</span><span class="dv">12</span>);</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    dtpany<span class="ot">=</span>(dtp<span class="sc">&gt;</span><span class="dv">0</span>);</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>run; </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.1" class="level3">
<h3 class="anchored" data-anchor-id="table-3.1">Table 3.1</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.1-r_d3c5122d4146cfb6b34b41c4b7df8897">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bissau<span class="sc">$</span>bcg, bissau<span class="sc">$</span>dtp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1    2    3
  0 1942   19    9    3
  1 1159 1299  582  261</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">table</span>(bissau<span class="sc">$</span>bcg, bissau<span class="sc">$</span>dtp) <span class="sc">/</span> <span class="fu">rowSums</span>(<span class="fu">table</span>(bissau<span class="sc">$</span>bcg, bissau<span class="sc">$</span>dtp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   
             0          1          2          3
  0 98.4287886  0.9630005  0.4561581  0.1520527
  1 35.1105726 39.3517116 17.6310209  7.9066949</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.1-sas_35d7e0264286bcf39ca479bac95a81a7">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>proc freq data<span class="ot">=</span>bissau;</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    tables bcg<span class="sc">*</span>dtp bcg<span class="sc">*</span>dtpany<span class="sc">/</span> nocol nopercent;</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.2" class="level3">
<h3 class="anchored" data-anchor-id="table-3.2">Table 3.2</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.2-r_42f67778a4a61d8b1f8ebd74f81bdab5">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(agein,ageout,dead<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">~</span>bcg,<span class="at">data=</span>bissau,<span class="at">method=</span><span class="st">"breslow"</span>,<span class="at">timefix=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(agein, ageout, dead != 0) ~ bcg, data = bissau, 
    method = "breslow", timefix = F)

       coef exp(coef) se(coef)      z      p
bcg -0.3558    0.7006   0.1407 -2.529 0.0114

Likelihood ratio test=6.28  on 1 df, p=0.01218
n= 5274, number of events= 222 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(agein,ageout,dead<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">~</span>dtpany,<span class="at">data=</span>bissau,<span class="at">method=</span><span class="st">"breslow"</span>,<span class="at">timefix=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(agein, ageout, dead != 0) ~ dtpany, data = bissau, 
    method = "breslow", timefix = F)

           coef exp(coef) se(coef)      z     p
dtpany -0.03855   0.96218  0.14904 -0.259 0.796

Likelihood ratio test=0.07  on 1 df, p=0.7958
n= 5274, number of events= 222 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(agein,ageout,dead<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">~</span>bcg<span class="sc">+</span>dtpany,<span class="at">data=</span>bissau,<span class="at">method=</span><span class="st">"breslow"</span>,<span class="at">timefix=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(agein, ageout, dead != 0) ~ bcg + dtpany, 
    data = bissau, method = "breslow", timefix = F)

          coef exp(coef) se(coef)      z      p
bcg    -0.5585    0.5720   0.1924 -2.902 0.0037
dtpany  0.3286    1.3890   0.2021  1.625 0.1041

Likelihood ratio test=9.01  on 2 df, p=0.01106
n= 5274, number of events= 222 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(agein,ageout,dead<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">~</span>bcg<span class="sc">*</span>dtpany,<span class="at">data=</span>bissau,<span class="at">method=</span><span class="st">"breslow"</span>,<span class="at">timefix=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(agein, ageout, dead != 0) ~ bcg * dtpany, 
    data = bissau, method = "breslow", timefix = F)

              coef exp(coef) se(coef)      z       p
bcg        -0.5764    0.5619   0.2023 -2.849 0.00439
dtpany      0.1252    1.1334   0.7178  0.174 0.86151
bcg:dtpany  0.2212    1.2475   0.7429  0.298 0.76595

Likelihood ratio test=9.1  on 3 df, p=0.02796
n= 5274, number of events= 222 </code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.2-sas_0b9a94b0ded83b55eb1008d13446253e">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bissau;</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    model ageout<span class="sc">*</span><span class="fu">dead</span>(<span class="dv">0</span>) <span class="ot">=</span> bcg <span class="sc">/</span> entry<span class="ot">=</span>agein rl;</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bissau;</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    model ageout<span class="sc">*</span><span class="fu">dead</span>(<span class="dv">0</span>) <span class="ot">=</span> dtpany <span class="sc">/</span> entry<span class="ot">=</span>agein rl;</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bissau;</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    model ageout<span class="sc">*</span><span class="fu">dead</span>(<span class="dv">0</span>) <span class="ot">=</span> bcg dtpany <span class="sc">/</span> entry<span class="ot">=</span>agein rl;</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bissau;</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    model ageout<span class="sc">*</span><span class="fu">dead</span>(<span class="dv">0</span>) <span class="ot">=</span> bcg dtpany bcg<span class="sc">*</span>dtpany <span class="sc">/</span> entry<span class="ot">=</span>agein rl;</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="testis-cancer-incidence-and-maternal-parity" class="level2">
<h2 class="anchored" data-anchor-id="testis-cancer-incidence-and-maternal-parity">Testis cancer incidence and maternal parity</h2>
<section id="read-data-2" class="level3">
<h3 class="anchored" data-anchor-id="read-data-2">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-testis-r_40bb80bdf1a1648b02e5c485dd1325b2">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>testis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/testis.csv"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add extra variables</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>lpyrs <span class="ot">&lt;-</span> <span class="fu">log</span>(testis<span class="sc">$</span>pyrs)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>par2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(testis<span class="sc">$</span>parity <span class="sc">&lt;</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-testis-sas_207e7df2e8d8776c0eaaf5ddc83ed564">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>proc import out<span class="ot">=</span>testis</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/testis.csv"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    dbms<span class="ot">=</span>csv replace;</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>data testis; </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    set testis; </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    lpyrs <span class="ot">=</span> <span class="fu">log</span>(pyrs); </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    par2 <span class="ot">=</span> (parity<span class="sc">&gt;=</span><span class="dv">2</span>); </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.1" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.1">Figure 3.1</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-out.widt="66%" data-hash="Ch3_cache/html/figure-3.1-r_439eac3b68e11cbd66826faec90c7454">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frames</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="dv">1900</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">58</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">73</span>), </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y1 =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x2 =</span> <span class="fu">rep</span>(<span class="dv">2000</span>, <span class="dv">5</span>), </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y2 =</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">58</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">73</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fl">1968.25</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">73</span><span class="fl">-68.25</span>), </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y1 =</span> <span class="fu">c</span>(<span class="fl">68.25</span> <span class="sc">-</span> <span class="dv">50</span>, <span class="fl">68.25</span> <span class="sc">-</span> <span class="dv">58</span>, <span class="fl">68.25</span> <span class="sc">-</span> <span class="dv">63</span>, <span class="fl">68.25</span> <span class="sc">-</span> <span class="dv">68</span>, <span class="dv">0</span>), </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x2 =</span> <span class="fu">rep</span>(<span class="dv">1993</span>, <span class="dv">5</span>), </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y2 =</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">58</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">73</span>) <span class="sc">-</span> <span class="dv">7</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">1968.25</span>, <span class="dv">1993</span>, <span class="fl">1968.25</span>, <span class="fl">1968.25</span>, <span class="fl">1968.25</span> <span class="sc">+</span> <span class="fl">1.75</span>, <span class="fl">1968.25</span> <span class="sc">+</span> <span class="fl">6.75</span>, <span class="fl">1968.25</span> <span class="sc">+</span> <span class="fl">11.75</span>), </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y1 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>), </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x2 =</span> <span class="fu">c</span>(<span class="fl">1968.25</span>, <span class="dv">1993</span>, <span class="dv">1993</span>, <span class="dv">1993</span>, <span class="dv">1993</span>, <span class="dv">1993</span>, <span class="dv">1993</span>), </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y2 =</span> <span class="fu">c</span>(<span class="fl">68.25</span> <span class="sc">-</span> <span class="dv">50</span>, <span class="dv">100</span> <span class="sc">-</span> <span class="dv">57</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>) </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># For labels</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">tapply</span>( testis<span class="sc">$</span>cases, <span class="fu">list</span>( testis<span class="sc">$</span>age, testis<span class="sc">$</span>cohort ), sum )</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">tapply</span>( testis<span class="sc">$</span>pyrs, <span class="fu">list</span>( testis<span class="sc">$</span>age, testis<span class="sc">$</span>cohort ), sum )</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">outer</span>( <span class="fu">unique</span>( testis<span class="sc">$</span>age )<span class="sc">+</span><span class="fu">c</span>(<span class="fl">17.5</span>,<span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>)),</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unique</span>( testis<span class="sc">$</span>cohort )<span class="sc">+</span><span class="fl">2.5</span>,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"+"</span> )</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> x[<span class="dv">1</span>,]<span class="sc">-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">outer</span>( <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">17</span>,<span class="dv">22</span>,<span class="dv">27</span>,<span class="dv">32</span>), <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="st">"*"</span> )</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>label_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x[<span class="sc">!</span><span class="fu">is.na</span>(Y)], </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> y[<span class="sc">!</span><span class="fu">is.na</span>(Y)], </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label =</span> <span class="fu">paste</span>( <span class="fu">round</span>( Y<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> )[<span class="sc">!</span><span class="fu">is.na</span>(Y)] )</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>label_data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1956</span>, <span class="at">y =</span> <span class="fl">47.5</span>, <span class="at">label =</span> <span class="st">"PY (10,000)"</span>)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>theme_general <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>), </span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>), </span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1) <span class="sc">+</span> </span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">1968.25</span>, <span class="dv">1993</span>),</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>),</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, </span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> x2, <span class="at">yend =</span> y2), </span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df1,</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> </span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, </span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> x2, <span class="at">yend =</span> y2), </span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df2,</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, </span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> x2, <span class="at">yend =</span> y2), </span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df3,</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  theme_general <span class="sc">+</span> </span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Calendar time"</span>) <span class="sc">+</span> </span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Age (years)"</span>) <span class="sc">+</span> </span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.005</span>)),</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1950</span>, <span class="dv">2000</span>), </span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>, <span class="dv">2000</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.005</span>)), </span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), </span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="fl">0.7</span>, </span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> label_data) <span class="sc">+</span> </span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>), <span class="st">"cm"</span>))</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.1-r-1.png" class="img-fluid" width="793"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.5" class="level3">
<h3 class="anchored" data-anchor-id="table-3.5">Table 3.5</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.5-r_713d9b220f9cb4f48eb5af1bdd19d5d3">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 1</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts=</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testis<span class="sc">$</span>age)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">relevel</span>(testis<span class="sc">$</span>age, <span class="at">ref =</span> <span class="st">'20'</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age, <span class="at">data =</span> testis, <span class="at">family =</span> poisson))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cases ~ offset(lpyrs) + par2 + age, family = poisson, 
    data = testis)

Coefficients:
            Estimate Std. Error  z value Pr(&gt;|z|)    
(Intercept) -9.04435    0.08393 -107.757  &lt; 2e-16 ***
par2         0.21663    0.08405    2.577  0.00996 ** 
age0        -4.03084    0.21105  -19.099  &lt; 2e-16 ***
age15       -1.17094    0.11886   -9.851  &lt; 2e-16 ***
age25        0.55962    0.09802    5.709 1.14e-08 ***
age30        0.75263    0.13272    5.671 1.42e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1647.61  on 236  degrees of freedom
Residual deviance:  201.07  on 231  degrees of freedom
AIC: 540.84

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 2</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>motherage <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testis<span class="sc">$</span>motherage)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>motherage <span class="ot">&lt;-</span> <span class="fu">relevel</span>(testis<span class="sc">$</span>motherage, <span class="at">ref =</span> <span class="st">"30"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>cohort <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testis<span class="sc">$</span>cohort)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>testis<span class="sc">$</span>cohort <span class="ot">&lt;-</span> <span class="fu">relevel</span>(testis<span class="sc">$</span>cohort, <span class="at">ref =</span> <span class="st">"1973"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisfull<span class="ot">&lt;-</span><span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> motherage <span class="sc">+</span> cohort, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> testis,<span class="at">family =</span> poisson))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cases ~ offset(lpyrs) + par2 + age + motherage + 
    cohort, family = poisson, data = testis)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -9.11684    0.29271 -31.146  &lt; 2e-16 ***
par2         0.22967    0.09112   2.521   0.0117 *  
age0        -4.00398    0.23905 -16.749  &lt; 2e-16 ***
age15       -1.16652    0.12522  -9.316  &lt; 2e-16 ***
age25        0.61710    0.10445   5.908 3.46e-09 ***
age30        0.95356    0.15378   6.201 5.62e-10 ***
motherage12  0.02926    0.24121   0.121   0.9034    
motherage20  0.05796    0.22233   0.261   0.7943    
motherage25 -0.11663    0.22510  -0.518   0.6044    
cohort1950  -0.36275    0.28800  -1.260   0.2078    
cohort1958  -0.08031    0.24838  -0.323   0.7464    
cohort1963   0.12346    0.23712   0.521   0.6026    
cohort1968   0.13376    0.23600   0.567   0.5709    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1647.6  on 236  degrees of freedom
Residual deviance:  190.2  on 224  degrees of freedom
AIC: 543.98

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(poisfull, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
   term        estimate std.error statistic   p.value  conf.low conf.high
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept) 0.000110    0.293    -31.1   5.74e-213 0.0000605  0.000191
 2 par2        1.26        0.0911     2.52  1.17e-  2 1.05       1.51    
 3 age0        0.0182      0.239    -16.7   5.72e- 63 0.0112     0.0286  
 4 age15       0.311       0.125     -9.32  1.21e- 20 0.243      0.397   
 5 age25       1.85        0.104      5.91  3.46e-  9 1.51       2.28    
 6 age30       2.59        0.154      6.20  5.62e- 10 1.91       3.50    
 7 motherage12 1.03        0.241      0.121 9.03e-  1 0.652      1.68    
 8 motherage20 1.06        0.222      0.261 7.94e-  1 0.698      1.68    
 9 motherage25 0.890       0.225     -0.518 6.04e-  1 0.583      1.41    
10 cohort1950  0.696       0.288     -1.26  2.08e-  1 0.398      1.23    
11 cohort1958  0.923       0.248     -0.323 7.46e-  1 0.574      1.52    
12 cohort1963  1.13        0.237      0.521 6.03e-  1 0.720      1.83    
13 cohort1968  1.14        0.236      0.567 5.71e-  1 0.729      1.84    </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for mother's age</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>poismage<span class="ot">&lt;-</span><span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> cohort, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> testis,<span class="at">family =</span> poisson)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(poisfull,poismage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: cases ~ offset(lpyrs) + par2 + age + motherage + cohort
Model 2: cases ~ offset(lpyrs) + par2 + age + cohort
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1  13 -258.99                     
2  10 -260.25 -3 2.5336     0.4692</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for birth cohort of son</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>poiscohort<span class="ot">&lt;-</span><span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> motherage, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> testis,<span class="at">family =</span> poisson)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(poisfull,poiscohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: cases ~ offset(lpyrs) + par2 + age + motherage + cohort
Model 2: cases ~ offset(lpyrs) + par2 + age + motherage
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)  
1  13 -258.99                       
2   9 -263.60 -4 9.2204    0.05582 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT parity and age</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>poisinteract<span class="ot">&lt;-</span><span class="fu">glm</span>(cases <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> motherage <span class="sc">+</span> cohort <span class="sc">+</span> par2<span class="sc">*</span>age, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> testis, <span class="at">family =</span> poisson)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(poisfull,poisinteract)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: cases ~ offset(lpyrs) + par2 + age + motherage + cohort
Model 2: cases ~ offset(lpyrs) + par2 + age + motherage + cohort + par2 * 
    age
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1  13 -258.99                     
2  17 -255.11  4 7.7606     0.1008</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HR for seminomas</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">glm</span>(semi <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> motherage <span class="sc">+</span> cohort, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> testis, <span class="at">family =</span> poisson),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">exponentiate =</span> T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
   term         estimate std.error statistic  p.value   conf.low conf.high
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept) 0.0000297     1.00   -10.4    1.98e-25 0.00000314  0.000178
 2 par2        1.23          0.171    1.23   2.19e- 1 0.886       1.73    
 3 age0        0.00297       1.13    -5.17   2.38e- 7 0.000147    0.0176  
 4 age15       0.0949        0.443   -5.32   1.03e- 7 0.0357      0.209   
 5 age25       2.98          0.200    5.47   4.55e- 8 2.03        4.44    
 6 age30       6.62          0.245    7.71   1.30e-14 4.11       10.8     
 7 motherage12 0.900         0.640   -0.164  8.69e- 1 0.295       3.94    
 8 motherage20 0.978         0.618   -0.0360 9.71e- 1 0.339       4.15    
 9 motherage25 1.23          0.617    0.338  7.35e- 1 0.427       5.22    
10 cohort1950  0.731         0.907   -0.345  7.30e- 1 0.140       5.71    
11 cohort1958  0.966         0.879   -0.0389 9.69e- 1 0.198       7.26    
12 cohort1963  0.862         0.869   -0.171  8.64e- 1 0.180       6.39    
13 cohort1968  0.691         0.879   -0.421  6.74e- 1 0.140       5.18    </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HR for non-seminomas</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">glm</span>(nonsemi <span class="sc">~</span> <span class="fu">offset</span>(lpyrs) <span class="sc">+</span> par2 <span class="sc">+</span> age <span class="sc">+</span> motherage <span class="sc">+</span> cohort, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> testis, <span class="at">family =</span> poisson),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">exponentiate =</span> T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
   term         estimate std.error statistic   p.value  conf.low conf.high
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept) 0.0000860     0.308   -30.4   7.09e-203 0.0000459  0.000154
 2 par2        1.27          0.108     2.19  2.88e-  2 1.03       1.56    
 3 age0        0.0223        0.246   -15.4   9.35e- 54 0.0135     0.0355  
 4 age15       0.369         0.133    -7.48  7.32e- 14 0.283      0.478   
 5 age25       1.49          0.125     3.21  1.35e-  3 1.17       1.91    
 6 age30       1.21          0.229     0.846 3.97e-  1 0.762      1.88    
 7 motherage12 1.09          0.264     0.341 7.33e-  1 0.662      1.87    
 8 motherage20 1.10          0.239     0.382 7.03e-  1 0.700      1.79    
 9 motherage25 0.804         0.244    -0.892 3.72e-  1 0.508      1.33    
10 cohort1950  0.639         0.328    -1.37  1.72e-  1 0.335      1.22    
11 cohort1958  0.828         0.264    -0.718 4.73e-  1 0.499      1.41    
12 cohort1963  1.15          0.247     0.550 5.82e-  1 0.715      1.89    
13 cohort1968  1.19          0.245     0.722 4.70e-  1 0.748      1.96    </code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.5-sas_55fe41dafc59f2f47890273972b378b6">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode sas code-with-copy"><code class="sourceCode highlightsas"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">* Column 1;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> genmod;</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    class age (ref=<span class="st">'20'</span>) par2 (ref=<span class="st">'1'</span>);</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">model</span> cases=par2 age/dist=poi offset=lpyrs type3;</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    estimate <span class="st">'RR'</span> par2 <span class="dv">1</span> -<span class="dv">1</span>/<span class="fu">exp</span>;</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">* Column 2;</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> genmod;</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    class age (ref=<span class="st">'20'</span>) motherage(ref=<span class="st">'30'</span>) cohort(ref=<span class="st">'1973'</span>) par2 (ref=<span class="st">'1'</span>);</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">model</span> cases=par2 age motherage cohort/dist=poi offset=lpyrs type3;</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    estimate <span class="st">'RR'</span> par2 <span class="dv">1</span> -<span class="dv">1</span>/<span class="fu">exp</span>;</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co">* In-text interaction test;</span> </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> genmod;</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    class age (ref=<span class="st">'20'</span>) motherage(ref=<span class="st">'30'</span>) cohort(ref=<span class="st">'1973'</span>) par2 (ref=<span class="st">'1'</span>);</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">model</span> cases=par2 age motherage cohort par2*age/dist=poi offset=lpyrs type3;</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="co">* seminomas;</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> genmod;</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    class age (ref=<span class="st">'20'</span>) motherage(ref=<span class="st">'30'</span>) cohort(ref=<span class="st">'1973'</span>) par2 (ref=<span class="st">'1'</span>);</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">model</span> semi=par2 age motherage cohort/dist=poi offset=lpyrs type3;</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    estimate <span class="st">'RR'</span> par2 <span class="dv">1</span> -<span class="dv">1</span>/<span class="fu">exp</span>;</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="co">* non-seminomas;</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="kw">proc</span> genmod;</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    class age (ref=<span class="st">'20'</span>) motherage(ref=<span class="st">'30'</span>) cohort(ref=<span class="st">'1973'</span>) par2 (ref=<span class="st">'1'</span>);</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">model</span> nonsemi=par2 age motherage cohort/dist=poi offset=lpyrs type3;</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    estimate <span class="st">'RR'</span> par2 <span class="dv">1</span> -<span class="dv">1</span>/<span class="fu">exp</span>;</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="kw">run</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="prova-trial-in-liver-cirrhosis" class="level2">
<h2 class="anchored" data-anchor-id="prova-trial-in-liver-cirrhosis">PROVA trial in liver cirrhosis</h2>
<section id="read-data-3" class="level3">
<h3 class="anchored" data-anchor-id="read-data-3">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-prova-r_c047acd80cd966148317f5811ffaf9e4">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>prova <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/prova.csv"</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"."</span>)))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment 2x2 factorial</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>prova<span class="sc">$</span>beh <span class="ot">&lt;-</span> <span class="fu">with</span>(prova, <span class="fu">as.factor</span>(scle <span class="sc">+</span> beta<span class="sc">*</span><span class="dv">2</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extra variables</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>provany <span class="ot">&lt;-</span> prova</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>log2bili <span class="ot">&lt;-</span> <span class="fu">with</span>(provany, <span class="fu">log2</span>(bili))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>btime    <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, provany<span class="sc">$</span>timebleed, provany<span class="sc">$</span>timedeath)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>d0time   <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, provany<span class="sc">$</span>timebleed, provany<span class="sc">$</span>timedeath)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>dead0    <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, provany<span class="sc">$</span>death)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>outof0   <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, provany<span class="sc">$</span>death)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>bdtime   <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, provany<span class="sc">$</span>timedeath, <span class="cn">NA</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>deadb    <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, provany<span class="sc">$</span>death, <span class="cn">NA</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>wait     <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(provany<span class="sc">$</span>bleed <span class="sc">==</span> <span class="dv">1</span>, provany<span class="sc">$</span>bdtime <span class="sc">-</span> provany<span class="sc">$</span>timebleed, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-prova-sas_2d8e61c2ed2b5b072fba685365742d73">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>proc import out<span class="ot">=</span>prova</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/prova.csv"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    dbms<span class="ot">=</span>csv replace;</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>data prova; </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    set prova; </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    beh <span class="ot">=</span> scle <span class="sc">+</span> beta<span class="sc">*</span><span class="dv">2</span>; </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    log2bili <span class="ot">=</span> <span class="fu">log2</span>(bili);</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bleed <span class="ot">=</span> <span class="dv">1</span> then wait <span class="ot">=</span> timedeath <span class="sc">-</span> timebleed;</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>data provany; </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    set prova;</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bleed<span class="ot">=</span><span class="dv">1</span> then do; btime<span class="ot">=</span>timebleed; d0time<span class="ot">=</span>timebleed; dead0<span class="ot">=</span><span class="dv">0</span>; outof0<span class="ot">=</span><span class="dv">1</span>; </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    bdtime<span class="ot">=</span>timedeath; deadb<span class="ot">=</span>death; wait<span class="ot">=</span>bdtime<span class="sc">-</span>timebleed; </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bleed<span class="ot">=</span><span class="dv">0</span> then do; btime<span class="ot">=</span>timedeath; d0time<span class="ot">=</span>timedeath; dead0<span class="ot">=</span>death; outof0<span class="ot">=</span>death; </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    bdtime<span class="ot">=</span>.; deadb<span class="ot">=</span>.; wait<span class="ot">=</span>.; end;</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    log2bili<span class="ot">=</span><span class="fu">log2</span>(bili);</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.3" class="level3">
<h3 class="anchored" data-anchor-id="table-3.3">Table 3.3</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.3-r_3d9b345c9b1778d7a77be79ce6f4bc91">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts=</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Column 1</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variceal bleeding</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bleed) <span class="sc">~</span> beh, <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bleed) ~ beh, data = provany, ties = "breslow")

         coef exp(coef) se(coef)      z     p
beh1  0.05563   1.05721  0.39235  0.142 0.887
beh2 -0.03972   0.96106  0.40039 -0.099 0.921
beh3 -0.03205   0.96846  0.40063 -0.080 0.936

Likelihood ratio test=0.07  on 3 df, p=0.9951
n= 286, number of events= 50 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># logrank test: Variceal bleeding</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>lr<span class="ot">&lt;-</span><span class="fu">survdiff</span>(<span class="fu">Surv</span>(btime, bleed) <span class="sc">~</span> beh, <span class="at">data =</span> provany)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(lr<span class="sc">$</span>chisq,lr<span class="sc">$</span>pvalue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07114524 0.99505932</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Death without bleeding</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>cox1<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(d0time, dead0) <span class="sc">~</span> beh, <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># logrank test: Death without bleeding</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>lr<span class="ot">&lt;-</span><span class="fu">survdiff</span>(<span class="fu">Surv</span>(d0time, dead0) <span class="sc">~</span> beh, <span class="at">data =</span> provany)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(lr<span class="sc">$</span>chisq,lr<span class="sc">$</span>pvalue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.856428541  0.004957601</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Death without bleeding - additive model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>cox2<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(d0time, dead0) <span class="sc">~</span> scle <span class="sc">+</span> beta, <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Death without bleeding - remove propranolol</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(cox2,cox1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(d0time, dead0) ~ scle + beta
Model 2: Surv(d0time, dead0) ~ beh
  #Df  LogLik Df Chisq Pr(&gt;Chisq)
1   2 -234.19                    
2   3 -233.38  1 1.627     0.2021</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cox3<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(d0time, dead0) <span class="sc">~</span> scle, <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(cox3,cox2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(d0time, dead0) ~ scle
Model 2: Surv(d0time, dead0) ~ scle + beta
  #Df  LogLik Df Chisq Pr(&gt;Chisq)
1   1 -234.36                    
2   2 -234.19  1 0.348     0.5553</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>cox3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(d0time, dead0) ~ scle, data = provany, ties = "breslow")

       coef exp(coef) se(coef)     z       p
scle 1.0180    2.7677   0.3281 3.103 0.00191

Likelihood ratio test=10.76  on 1 df, p=0.001037
n= 286, number of events= 46 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Column 2</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Variceal bleeding</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bleed) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> coag <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">factor</span>(varsize),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bleed) ~ beh + sex + coag + log2bili + 
    factor(varsize), data = provany, ties = "breslow")

                      coef exp(coef)  se(coef)      z        p
beh1              0.176844  1.193445  0.433336  0.408  0.68320
beh2              0.207005  1.229989  0.424001  0.488  0.62539
beh3              0.030562  1.031034  0.420784  0.073  0.94210
sex              -0.025865  0.974467  0.329095 -0.079  0.93736
coag             -0.020647  0.979565  0.007819 -2.641  0.00827
log2bili          0.191011  1.210473  0.149142  1.281  0.20029
factor(varsize)2  0.741460  2.098998  0.414959  1.787  0.07397
factor(varsize)3  1.884681  6.584252  0.442325  4.261 2.04e-05

Likelihood ratio test=37.67  on 8 df, p=8.654e-06
n= 271, number of events= 47 
   (15 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Death without bleeding</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(d0time, dead0) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> coag <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">factor</span>(varsize),</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(d0time, dead0) ~ beh + sex + coag + log2bili + 
    factor(varsize), data = provany, ties = "breslow")

                      coef exp(coef)  se(coef)      z       p
beh1              0.826468  2.285233  0.458574  1.802 0.07151
beh2             -0.159630  0.852459  0.575047 -0.278 0.78132
beh3              0.910385  2.485279  0.420391  2.166 0.03034
sex               0.841579  2.320027  0.415722  2.024 0.04293
coag             -0.008112  0.991920  0.006804 -1.192 0.23312
log2bili          0.445359  1.561051  0.136749  3.257 0.00113
factor(varsize)2  0.221738  1.248245  0.347159  0.639 0.52300
factor(varsize)3  0.753294  2.123984  0.448544  1.679 0.09307

Likelihood ratio test=42.13  on 8 df, p=1.283e-06
n= 271, number of events= 46 
   (15 observations deleted due to missingness)</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.3-sas_a96aca90f3506000c0fc470d7e6e031b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Table <span class="fl">3.3</span> column <span class="dv">1</span>;</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Variceal bleeding; </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> logrank test is the score test;</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    model btime<span class="sc">*</span><span class="fu">bleed</span>(<span class="dv">0</span>)<span class="ot">=</span>beh  <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Death without bleeding; </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> logrank test is the score test;</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    model d0time<span class="sc">*</span><span class="fu">dead0</span>(<span class="dv">0</span>)<span class="ot">=</span>beh <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Death without bleeding <span class="sc">-</span> <span class="cf">in</span> text LRT <span class="cf">for</span> additive model; </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    model d0time<span class="sc">*</span><span class="fu">dead0</span>(<span class="dv">0</span>)<span class="ot">=</span>scle<span class="sc">|</span>beta <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    estimate <span class="st">'both'</span> scle <span class="dv">1</span> beta <span class="dv">1</span> scle<span class="sc">*</span>beta <span class="dv">1</span>;</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    model d0time<span class="sc">*</span><span class="fu">dead0</span>(<span class="dv">0</span>)<span class="ot">=</span>scle beta <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Death without bleeding <span class="sc">-</span> remove propranolol;</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    model d0time<span class="sc">*</span><span class="fu">dead0</span>(<span class="dv">0</span>)<span class="ot">=</span>scle <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Table <span class="fl">3.3</span> column <span class="dv">2</span>;</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Variceal bleeding;</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) <span class="fu">varsize</span> (<span class="at">ref=</span><span class="st">'1'</span>);</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>    model btime<span class="sc">*</span><span class="fu">bleed</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex coag log2bili varsize <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Death without bleeding; </span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) <span class="fu">varsize</span> (<span class="at">ref=</span><span class="st">'1'</span>);</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    model d0time<span class="sc">*</span><span class="fu">dead0</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex coag log2bili varsize <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.4" class="level3">
<h3 class="anchored" data-anchor-id="table-3.4">Table 3.4</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.4-r_ab18d516f65e68ffba4312b0c8da699e">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Composite</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>cox<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, outof0) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> coag <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">factor</span>(varsize),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>cox</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, outof0) ~ beh + sex + coag + log2bili + 
    factor(varsize), data = provany, ties = "breslow")

                      coef exp(coef)  se(coef)      z        p
beh1              0.525145  1.690704  0.312502  1.680  0.09287
beh2              0.100189  1.105380  0.337918  0.296  0.76686
beh3              0.494807  1.640181  0.291638  1.697  0.08976
sex               0.360259  1.433701  0.253379  1.422  0.15508
coag             -0.013600  0.986492  0.005287 -2.572  0.01010
log2bili          0.328376  1.388711  0.101761  3.227  0.00125
factor(varsize)2  0.446403  1.562681  0.263275  1.696  0.08997
factor(varsize)3  1.332535  3.790639  0.301391  4.421 9.81e-06

Likelihood ratio test=65.71  on 8 df, p=3.489e-11
n= 271, number of events= 93 
   (15 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for treatment</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>coxreduced<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, outof0) <span class="sc">~</span> sex <span class="sc">+</span> coag <span class="sc">+</span> log2bili <span class="sc">+</span> <span class="fu">factor</span>(varsize),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxreduced,cox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(btime, outof0) ~ sex + coag + log2bili + factor(varsize)
Model 2: Surv(btime, outof0) ~ beh + sex + coag + log2bili + factor(varsize)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   5 -457.74                     
2   8 -455.35  3 4.7717     0.1893</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.4-sas_831be4a3905fb6f733a2412418c9c2e3">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) <span class="fu">varsize</span> (<span class="at">ref=</span><span class="st">'1'</span>);</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    model btime<span class="sc">*</span><span class="fu">outof0</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex coag log2bili varsize  <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.8" class="level3">
<h3 class="anchored" data-anchor-id="table-3.8">Table 3.8</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.8-r_d9da5ac76de40191545f62dbd97b6cc7">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time since randomization (tsr)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 1</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>coxtsr<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> log2bili, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>coxtsr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bdtime, deadb != 0) ~ beh + sex + 
    log2bili, data = provany, ties = "breslow")

            coef exp(coef) se(coef)      z      p
beh1     -1.4127    0.2435   0.6787 -2.081 0.0374
beh2     -0.1146    0.8918   0.5952 -0.192 0.8474
beh3      0.7327    2.0807   0.5439  1.347 0.1780
sex       1.1389    3.1234   0.5039  2.260 0.0238
log2bili  0.1088    1.1149   0.2075  0.524 0.6001

Likelihood ratio test=15.35  on 5 df, p=0.008958
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>coxtsr0<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> sex <span class="sc">+</span> log2bili, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>coxtsr0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bdtime, deadb != 0) ~ sex + log2bili, 
    data = provany, ties = "breslow")

            coef exp(coef) se(coef)      z      p
sex       0.9095    2.4830   0.4807  1.892 0.0585
log2bili -0.1618    0.8506   0.1826 -0.886 0.3758

Likelihood ratio test=4.19  on 2 df, p=0.1232
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for beh</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxtsr,coxtsr0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(btime, bdtime, deadb != 0) ~ beh + sex + log2bili
Model 2: Surv(btime, bdtime, deadb != 0) ~ sex + log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)  
1   5 -59.626                       
2   2 -65.208 -3 11.164    0.01087 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>coxnoint<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> scle <span class="sc">+</span> beta  <span class="sc">+</span> sex <span class="sc">+</span> log2bili, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT interaction</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxnoint,coxtsr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(btime, bdtime, deadb != 0) ~ scle + beta + sex + log2bili
Model 2: Surv(btime, bdtime, deadb != 0) ~ beh + sex + log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)   
1   4 -63.061                        
2   5 -59.626  1 6.8707   0.008762 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 2</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>tsb<span class="ot">&lt;-</span>provany<span class="sc">$</span>btime</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>coxtsr_tt<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> log2bili<span class="sc">+</span><span class="fu">tt</span>(tsb), </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">dt1=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&lt;</span><span class="dv">5</span>), <span class="at">dt2=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;=</span><span class="dv">5</span> <span class="sc">&amp;</span> dt<span class="sc">&lt;</span><span class="dv">10</span>))</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>coxtsr_tt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bdtime, deadb != 0) ~ beh + sex + 
    log2bili + tt(tsb), data = provany, ties = "breslow", tt = function(x, 
    t, ...) {
    dt &lt;- t - x
    cbind(dt1 = 1 * (dt &lt; 5), dt2 = 1 * (dt &gt;= 5 &amp; dt &lt; 10))
})

               coef exp(coef) se(coef)      z        p
beh1       -1.15606   0.31472  0.68428 -1.689  0.09113
beh2       -0.02371   0.97657  0.63136 -0.038  0.97005
beh3        0.42544   1.53026  0.61129  0.696  0.48645
sex         1.11875   3.06103  0.53261  2.101  0.03568
log2bili   -0.04822   0.95292  0.22285 -0.216  0.82869
tt(tsb)dt1  2.94285  18.96981  0.73891  3.983 6.81e-05
tt(tsb)dt2  2.34525  10.43583  0.80285  2.921  0.00349

Likelihood ratio test=33.65  on 7 df, p=2.005e-05
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for time-dependent covariates</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxtsr_tt,coxtsr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(btime, bdtime, deadb != 0) ~ beh + sex + log2bili + tt(tsb)
Model 2: Surv(btime, bdtime, deadb != 0) ~ beh + sex + log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   7 -50.478                         
2   5 -59.626 -2 18.295  0.0001065 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for beh</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>coxtsr_tt_reduced<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> sex <span class="sc">+</span> log2bili<span class="sc">+</span><span class="fu">tt</span>(tsb), </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                   dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">cbind</span>(<span class="at">dt1=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&lt;</span><span class="dv">5</span>), <span class="at">dt2=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;=</span><span class="dv">5</span> <span class="sc">&amp;</span> dt<span class="sc">&lt;</span><span class="dv">10</span>))</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                 })</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxtsr_tt_reduced,coxtsr_tt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(btime, bdtime, deadb != 0) ~ sex + log2bili + tt(tsb)
Model 2: Surv(btime, bdtime, deadb != 0) ~ beh + sex + log2bili + tt(tsb)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   4 -53.081                     
2   7 -50.478  3 5.2064     0.1573</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In text, model linear effect of time-dependent covariate</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> beh<span class="sc">+</span>sex <span class="sc">+</span> log2bili<span class="sc">+</span><span class="fu">tt</span>(tsb), </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...){t<span class="sc">-</span>x})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(btime, bdtime, deadb != 0) ~ beh + sex + 
    log2bili + tt(tsb), data = provany, ties = "breslow", tt = function(x, 
    t, ...) {
    t - x
})

              coef exp(coef)  se(coef)      z       p
beh1     -1.462260  0.231712  0.685283 -2.134 0.03286
beh2     -0.028375  0.972024  0.620246 -0.046 0.96351
beh3      0.599364  1.820960  0.574135  1.044 0.29651
sex       0.899664  2.458776  0.530853  1.695 0.09012
log2bili  0.349775  1.418749  0.224830  1.556 0.11977
tt(tsb)  -0.005179  0.994834  0.001769 -2.927 0.00342

Likelihood ratio test=25.54  on 6 df, p=0.0002708
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duration</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 1</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>coxdur<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(wait, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> log2bili,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>coxdur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(wait, deadb != 0) ~ beh + sex + log2bili, 
    data = provany, ties = "breslow")

            coef exp(coef) se(coef)      z     p
beh1     -0.9971    0.3689   0.6429 -1.551 0.121
beh2     -0.2995    0.7412   0.5965 -0.502 0.616
beh3      0.8708    2.3889   0.5136  1.695 0.090
sex       0.6497    1.9149   0.5264  1.234 0.217
log2bili  0.2677    1.3070   0.1790  1.496 0.135

Likelihood ratio test=13.24  on 5 df, p=0.0212
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>coxdur0<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(wait, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> sex <span class="sc">+</span> log2bili,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>coxdur0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(wait, deadb != 0) ~ sex + log2bili, data = provany, 
    ties = "breslow")

           coef exp(coef) se(coef)     z     p
sex      0.6742    1.9625   0.4662 1.446 0.148
log2bili 0.1210    1.1286   0.1677 0.721 0.471

Likelihood ratio test=3.03  on 2 df, p=0.2195
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for beh</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxdur,coxdur0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(wait, deadb != 0) ~ beh + sex + log2bili
Model 2: Surv(wait, deadb != 0) ~ sex + log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)  
1   5 -86.494                       
2   2 -91.600 -3 10.211    0.01685 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 2</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>provany<span class="sc">$</span>tsr<span class="ot">&lt;-</span>provany<span class="sc">$</span>btime</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>coxdur_tt<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(wait, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> beh <span class="sc">+</span> sex <span class="sc">+</span> log2bili<span class="sc">+</span><span class="fu">tt</span>(tsr),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> x<span class="sc">+</span>t</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">v1=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">*</span><span class="fl">365.25</span>), <span class="at">v2=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">*</span><span class="fl">365.25</span> <span class="sc">&amp;</span> dt<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>))</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>coxdur_tt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(wait, deadb != 0) ~ beh + sex + log2bili + 
    tt(tsr), data = provany, ties = "breslow", tt = function(x, 
    t, ...) {
    dt &lt;- x + t
    cbind(v1 = 1 * (dt &lt; 1 * 365.25), v2 = 1 * (dt &gt;= 1 * 365.25 &amp; 
        dt &lt; 2 * 365.25))
})

             coef exp(coef) se(coef)      z     p
beh1      -1.0192    0.3609   0.6502 -1.567 0.117
beh2      -0.3116    0.7323   0.6005 -0.519 0.604
beh3       0.8467    2.3320   0.5244  1.615 0.106
sex        0.6441    1.9043   0.5303  1.215 0.225
log2bili   0.2829    1.3269   0.1966  1.439 0.150
tt(tsr)v1 -0.1723    0.8417   0.9096 -0.189 0.850
tt(tsr)v2 -0.2211    0.8016   0.8862 -0.250 0.803

Likelihood ratio test=13.31  on 7 df, p=0.065
n= 48, number of events= 27 
   (238 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for time-dependent covariates</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(coxdur,coxdur_tt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(wait, deadb != 0) ~ beh + sex + log2bili
Model 2: Surv(wait, deadb != 0) ~ beh + sex + log2bili + tt(tsr)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   5 -86.494                     
2   7 -86.464  2 0.0618     0.9696</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>coxdur_tt_reduced<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(btime, bdtime, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> sex <span class="sc">+</span> log2bili<span class="sc">+</span><span class="fu">tt</span>(tsb), </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> provany, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                           dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">cbind</span>(<span class="at">dt1=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&lt;</span><span class="dv">5</span>), <span class="at">dt2=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;=</span><span class="dv">5</span> <span class="sc">&amp;</span> dt<span class="sc">&lt;</span><span class="dv">10</span>))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                         })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.8-sas_ad83ec56879571c89bc955cc13aa7cf9">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Time since randomisation;</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">1</span>; </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany atrisk;</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    model bdtime<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili <span class="sc">/</span> entry<span class="ot">=</span>btime rl <span class="fu">type3</span>(lr);</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> LRT interaction scle<span class="sc">*</span>beta;</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany atrisk;</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    model bdtime<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>scle<span class="sc">|</span>beta sex log2bili <span class="sc">/</span> entry<span class="ot">=</span>btime rl <span class="fu">type3</span>(lr);</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">2</span>; </span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>proc phreg  data<span class="ot">=</span>provany;</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>    model bdtime<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili wait1 wait2 <span class="sc">/</span> entry<span class="ot">=</span>btime rl <span class="fu">type3</span>(lr);</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    wait1<span class="ot">=</span><span class="dv">0</span>; wait2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (bdtime<span class="sc">-</span>btime<span class="sc">&lt;</span><span class="dv">5</span>) then wait1<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="dv">5</span><span class="sc">&lt;=</span>bdtime<span class="sc">-</span>btime<span class="sc">&lt;</span><span class="dv">10</span>) then wait2<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>    duration<span class="sc">:</span> test wait1<span class="ot">=</span><span class="dv">0</span>, wait2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> In text<span class="sc">:</span> Linear effect of time<span class="sc">-</span>dependent covariate;</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>proc phreg  data<span class="ot">=</span>provany;</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>    model bdtime<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili lin <span class="sc">/</span> entry<span class="ot">=</span>btime rl <span class="fu">type3</span>(lr);</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    lin<span class="ot">=</span>bdtime<span class="sc">-</span>btime;</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Duration; </span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">1</span>; </span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>    model wait<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>cumhazwait cumhaz<span class="ot">=</span>breslowwait covariates<span class="ot">=</span>covar;</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">2</span>;</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>    model wait<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili time1 time2 <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>    time1<span class="ot">=</span><span class="dv">0</span>; time2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (btime<span class="sc">+</span>wait<span class="sc">&lt;</span><span class="fl">365.25</span>) then time1<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fl">365.25</span><span class="sc">&lt;=</span>btime<span class="sc">+</span>wait<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>) then time2<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a>    timeeff<span class="sc">:</span> test time1<span class="ot">=</span><span class="dv">0</span>, time2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.2" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.2">Figure 3.2</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.2-r_1d281b093e4869d899c1229cd12c77d0">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting style </span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>theme_general <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make zeros print as "0" always for plot axes</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>prettyZero <span class="ot">&lt;-</span> <span class="cf">function</span>(l){</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  max.decimals <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">nchar</span>(<span class="fu">str_extract</span>(l, <span class="st">"</span><span class="sc">\\</span><span class="st">.[0-9]+"</span>)), <span class="at">na.rm =</span> T)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  lnew <span class="ot">=</span> <span class="fu">formatC</span>(l, <span class="at">replace.zero =</span> T, <span class="at">zero.print =</span> <span class="st">"0"</span>,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits =</span> max.decimals, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">preserve.width=</span>T)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lnew)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract cumulative baseline hazard</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>coxcumhaz <span class="ot">&lt;-</span> <span class="fu">survfit</span>(coxtsr, </span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">sex =</span> <span class="dv">0</span>, </span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beh =</span> <span class="st">"0"</span>, </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">log2bili =</span> <span class="dv">0</span>))</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect data for plot</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>coxdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> <span class="fu">append</span>(<span class="dv">0</span>,coxcumhaz<span class="sc">$</span>cumhaz), </span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> <span class="fu">append</span>(<span class="dv">0</span>,coxcumhaz<span class="sc">$</span>time), </span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="fu">rep</span>(<span class="st">"Breslow estimate"</span>, <span class="dv">1</span><span class="sc">+</span><span class="fu">length</span>(coxcumhaz<span class="sc">$</span>time)))</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.2</span></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time <span class="sc">/</span> <span class="fl">365.25</span>, <span class="at">y =</span> cumhaz), <span class="at">data =</span> coxdata) <span class="sc">+</span> </span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since randomization (years)"</span>) <span class="sc">+</span> </span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative hazard"</span>) <span class="sc">+</span> </span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span> </span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.2-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.2-sas_67269faee9b4714fefdf2df3521e4590">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>data covar; </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    input beh sex log2bili; </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    datalines; </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>; </span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany atrisk;</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    model bdtime<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili<span class="sc">/</span>entry<span class="ot">=</span>btime rl <span class="fu">type3</span>(lr);</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>cumhaztime cumhaz<span class="ot">=</span>breslowtime covariates<span class="ot">=</span>covar;</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>data cumhaztime;</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    set cumhaztime; </span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    bdtimeyears <span class="ot">=</span> bdtime <span class="sc">/</span> <span class="fl">365.25</span>; </span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>cumhaztime;</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    plot breslowtime<span class="sc">*</span>bdtimeyears<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2;</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">4</span> by <span class="dv">1</span> minor<span class="ot">=</span>none </span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>          label<span class="ot">=</span>(<span class="st">'Time since randomization (Years)'</span>);</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">1.1</span> by <span class="fl">0.1</span> minor<span class="ot">=</span>none label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative hazard'</span>);</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.3" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.3">Figure 3.3</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.3-r_1591c892759b30c2fc888eefb8d1396c">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract cumulative baseline hazard</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>coxcumhaz <span class="ot">&lt;-</span> <span class="fu">survfit</span>(coxdur, </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">sex =</span> <span class="dv">0</span>, </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">beh =</span> <span class="st">"0"</span>, </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">log2bili =</span> <span class="dv">0</span>))</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect data for plot</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>coxdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> <span class="fu">append</span>(<span class="dv">0</span>,coxcumhaz<span class="sc">$</span>cumhaz), </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> <span class="fu">append</span>(<span class="dv">0</span>,coxcumhaz<span class="sc">$</span>time), </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="fu">rep</span>(<span class="st">"Breslow estimate"</span>, <span class="dv">1</span><span class="sc">+</span><span class="fu">length</span>(coxcumhaz<span class="sc">$</span>time)))</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.3</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time <span class="sc">/</span> <span class="fl">365.25</span>, <span class="at">y =</span> cumhaz), <span class="at">data =</span> coxdata) <span class="sc">+</span> </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Duration (years)"</span>) <span class="sc">+</span> </span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative hazard"</span>) <span class="sc">+</span> </span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), ) <span class="sc">+</span> </span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)),<span class="at">labels =</span> prettyZero) <span class="sc">+</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.3-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.3-sas_21a89c52acec685b47835a58dd56523b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Duration; </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>data covar; </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    input beh sex log2bili; </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    datalines; </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>; </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>provany;</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    model wait<span class="sc">*</span><span class="fu">deadb</span>(<span class="dv">0</span>)<span class="ot">=</span>beh sex log2bili <span class="sc">/</span> <span class="fu">type3</span>(lr);</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>cumhazwait cumhaz<span class="ot">=</span>breslowwait covariates<span class="ot">=</span>covar;</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>data cumhazwait;</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    set cumhazwait; </span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>    waityears <span class="ot">=</span> wait <span class="sc">/</span> <span class="fl">365.25</span>; </span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>cumhazwait;</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    plot breslowwait<span class="sc">*</span>waityears<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2;</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">4</span> by <span class="dv">1</span> minor<span class="ot">=</span>none label<span class="ot">=</span>(<span class="st">'Duration (Years)'</span>);</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.2</span> by <span class="fl">0.05</span> minor<span class="ot">=</span>none label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative hazard'</span>);</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.9" class="level3">
<h3 class="anchored" data-anchor-id="table-3.9">Table 3.9</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.9-r_6c4a31314bebe0fd00e9a61efdd3a86a">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All bleeds</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>provasplit11 <span class="ot">&lt;-</span> <span class="fu">subset</span>(provany, bleed <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Split by duration</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>provasplit1 <span class="ot">&lt;-</span> <span class="fu">survSplit</span>(<span class="fu">Surv</span>(wait, deadb <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> ., <span class="at">data =</span> provasplit11, </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cut =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">episode =</span> <span class="st">"wint"</span>)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>provasplit1<span class="sc">$</span>start <span class="ot">&lt;-</span> <span class="fu">with</span>(provasplit1, </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>                            btime <span class="sc">+</span> <span class="fu">ifelse</span>(wint <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(wint <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">5</span> , <span class="dv">10</span>))</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>provasplit1<span class="sc">$</span>stop <span class="ot">&lt;-</span> <span class="fu">with</span>(provasplit1, btime <span class="sc">+</span> wait)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>provasplit1<span class="sc">$</span>risktime <span class="ot">&lt;-</span> <span class="fu">with</span>(provasplit1, wait <span class="sc">-</span> tstart)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>provasplit1<span class="sc">$</span>logrisktime <span class="ot">&lt;-</span> <span class="fu">log</span>(provasplit1<span class="sc">$</span>risktime)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>provasplit1<span class="sc">$</span>fail <span class="ot">&lt;-</span> provasplit1<span class="sc">$</span>event</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Split by time since rand (t)</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>provasplit2 <span class="ot">&lt;-</span> <span class="fu">survSplit</span>(<span class="fu">Surv</span>(start, stop, fail) <span class="sc">~</span> ., <span class="at">data =</span> provasplit1, </span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cut =</span> <span class="fu">c</span>((<span class="dv">1</span>) <span class="sc">*</span> <span class="fl">365.25</span>, (<span class="dv">2</span>) <span class="sc">*</span> <span class="fl">365.25</span>),</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">episode =</span> <span class="st">"tint"</span>)</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>provasplit2<span class="sc">$</span>risktime2 <span class="ot">&lt;-</span> <span class="fu">with</span>(provasplit2, stop <span class="sc">-</span> start)</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>provasplit2<span class="sc">$</span>risktimeys2 <span class="ot">&lt;-</span> provasplit2<span class="sc">$</span>risktime2 <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>provasplit2<span class="sc">$</span>logrisktime2 <span class="ot">&lt;-</span> <span class="fu">log</span>(provasplit2<span class="sc">$</span>risktime2)</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>provasplit2<span class="sc">$</span>fail2 <span class="ot">&lt;-</span> provasplit2<span class="sc">$</span>fail</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data, Table 3.9 output</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(fail2, risktimeys2) <span class="sc">~</span> tint <span class="sc">+</span> wint, provasplit2, </span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">count =</span> <span class="fu">length</span>(x),</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sum =</span> <span class="fu">sum</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  tint wint fail2.count fail2.sum risktimeys2.count risktimeys2.sum
1    1    1          39         8       39.00000000      0.46338125
2    2    1          11         2       11.00000000      0.13073238
3    3    1           1         0        1.00000000      0.01368925
4    1    2          30         2       30.00000000      0.38603696
5    2    2           9         1        9.00000000      0.11635866
6    3    2           1         0        1.00000000      0.01368925
7    1    3          28         7       28.00000000     12.42984257
8    2    3          28         5       28.00000000     19.88227242
9    3    3          19         4       19.00000000     21.56468172</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.9-sas_2849caaa86976eca9e7e236aab9e244b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>data provasplit1;</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    set provany;</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    where bleed<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    fail<span class="ot">=</span>(wait<span class="sc">&lt;</span><span class="dv">5</span>)<span class="sc">*</span>(deadb ne <span class="dv">0</span>);</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    risktime<span class="ot">=</span><span class="fu">min</span>(<span class="dv">5</span>,wait);</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    logrisk<span class="ot">=</span><span class="fu">log</span>(risktime); wint<span class="ot">=</span><span class="dv">1</span>; </span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    start<span class="ot">=</span>btime; slut<span class="ot">=</span>btime<span class="sc">+</span><span class="fu">min</span>(<span class="dv">5</span>,wait); output;  </span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> wait<span class="sc">&gt;=</span><span class="dv">5</span> then do;</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    fail<span class="ot">=</span>(wait<span class="sc">&lt;</span><span class="dv">10</span>)<span class="sc">*</span>(deadb ne <span class="dv">0</span>);</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    risktime<span class="ot">=</span><span class="fu">min</span>(<span class="dv">5</span>,wait<span class="dv">-5</span>);</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    logrisk<span class="ot">=</span><span class="fu">log</span>(risktime); wint<span class="ot">=</span><span class="dv">2</span>; </span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    start<span class="ot">=</span>btime<span class="sc">+</span><span class="dv">5</span>; slut<span class="ot">=</span>btime<span class="sc">+</span><span class="fu">min</span>(<span class="dv">10</span>,wait); output; end;</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> wait<span class="sc">&gt;</span><span class="dv">10</span> then do;</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>    fail<span class="ot">=</span>deadb ne <span class="dv">0</span>; </span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    risktime<span class="ot">=</span>wait<span class="dv">-10</span>;</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    logrisk<span class="ot">=</span><span class="fu">log</span>(risktime); wint<span class="ot">=</span><span class="dv">3</span>; </span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    start<span class="ot">=</span>btime<span class="sc">+</span><span class="dv">10</span>; slut<span class="ot">=</span>btime<span class="sc">+</span>wait; output; end;</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>data provasplit2; </span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>    set provasplit1;</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start<span class="sc">&lt;</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span><span class="fu">min</span>(slut,<span class="fl">365.25</span>)<span class="sc">-</span>start;</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail<span class="sc">*</span>(slut<span class="sc">&lt;</span><span class="fl">365.25</span>); logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2); tint<span class="ot">=</span><span class="dv">1</span>; output;</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> slut<span class="sc">&gt;</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span><span class="fu">min</span>(slut,<span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>)<span class="sc">-</span><span class="fl">365.25</span>; logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2);</span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail<span class="sc">*</span>(slut<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>); tint<span class="ot">=</span><span class="dv">2</span>; output; end;</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> slut<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span>slut<span class="dv">-2</span><span class="sc">*</span><span class="fl">365.25</span>; logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2);</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail; tint<span class="ot">=</span><span class="dv">3</span>; output; end;</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fl">365.25</span><span class="sc">&lt;=</span>start<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span><span class="fu">min</span>(slut,<span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>)<span class="sc">-</span>start;</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail<span class="sc">*</span>(slut<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span>); logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2); tint<span class="ot">=</span><span class="dv">2</span>; output;</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> slut<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span>slut<span class="dv">-2</span><span class="sc">*</span><span class="fl">365.25</span>; logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2);</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail; tint<span class="ot">=</span><span class="dv">3</span>; output; end;</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start<span class="sc">&gt;=</span><span class="dv">2</span><span class="sc">*</span><span class="fl">365.25</span> then do; risktime2<span class="ot">=</span>slut<span class="sc">-</span>start; logrisk2<span class="ot">=</span><span class="fu">log</span>(risktime2);</span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>    fail2<span class="ot">=</span>fail; tint<span class="ot">=</span><span class="dv">3</span>; output; </span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>end;</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>data provasplit2; </span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>    set provasplit2;</span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>    risktime2ys<span class="ot">=</span>risktime2<span class="sc">/</span><span class="fl">365.25</span>;</span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>proc means data<span class="ot">=</span>provasplit2 sum; </span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>    class wint tint;</span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>    var fail2 risktime2ys;</span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.10" class="level3">
<h3 class="anchored" data-anchor-id="table-3.10">Table 3.10</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.10-r_b07eb95fcb6304f72afd767ce2e34eac">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part (a)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(fail <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime)) <span class="sc">+</span> beh <span class="sc">+</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(wint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span> </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>              sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit1, <span class="at">family =</span> poisson))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = fail ~ offset(log(risktime)) + beh + relevel(as.factor(wint), 
    ref = "3") + sex + log2bili, family = poisson, data = provasplit1)

Coefficients:
                                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -8.8925     1.1282  -7.882 3.21e-15 ***
beh1                                  -1.1301     0.6423  -1.759   0.0785 .  
beh2                                  -0.3138     0.5887  -0.533   0.5940    
beh3                                   0.9667     0.5157   1.874   0.0609 .  
relevel(as.factor(wint), ref = "3")1   3.6024     0.4387   8.212  &lt; 2e-16 ***
relevel(as.factor(wint), ref = "3")2   2.8437     0.6373   4.462 8.11e-06 ***
sex                                    0.7327     0.5190   1.412   0.1581    
log2bili                               0.2877     0.1824   1.577   0.1147    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 225.56  on 122  degrees of freedom
Residual deviance: 149.88  on 115  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 219.88

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part (b)</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(tint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>              sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(tint), 
    ref = "3") + sex + log2bili, family = poisson, data = provasplit2)

Coefficients:
                                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -8.6775     1.2008  -7.226 4.96e-13 ***
beh1                                  -1.2810     0.6522  -1.964   0.0495 *  
beh2                                  -0.4317     0.5657  -0.763   0.4454    
beh3                                   0.8006     0.5254   1.524   0.1275    
relevel(as.factor(tint), ref = "3")1   1.5068     0.5785   2.605   0.0092 ** 
relevel(as.factor(tint), ref = "3")2   0.4304     0.6482   0.664   0.5067    
sex                                    0.9494     0.4922   1.929   0.0538 .  
log2bili                               0.1792     0.2049   0.875   0.3817    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 237.84  on 160  degrees of freedom
Residual deviance: 202.95  on 153  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 272.95

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part (c)</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">relevel</span>(<span class="fu">as.factor</span>(wint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">relevel</span>(<span class="fu">as.factor</span>(tint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>              sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(wint), 
    ref = "3") + relevel(as.factor(tint), ref = "3") + sex + 
    log2bili, family = poisson, data = provasplit2)

Coefficients:
                                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -8.9276     1.1636  -7.673 1.68e-14 ***
beh1                                  -1.1101     0.6475  -1.714   0.0864 .  
beh2                                  -0.3181     0.5788  -0.550   0.5826    
beh3                                   0.8260     0.5138   1.608   0.1079    
relevel(as.factor(wint), ref = "3")1   3.3500     0.4641   7.219 5.25e-13 ***
relevel(as.factor(wint), ref = "3")2   2.5827     0.6593   3.917 8.97e-05 ***
relevel(as.factor(tint), ref = "3")1   0.7325     0.6176   1.186   0.2356    
relevel(as.factor(tint), ref = "3")2   0.1889     0.6546   0.289   0.7729    
sex                                    0.7672     0.5090   1.507   0.1317    
log2bili                               0.2301     0.1900   1.211   0.2260    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 237.84  on 160  degrees of freedom
Residual deviance: 160.21  on 151  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 234.21

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction model, in-text but not shown</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> <span class="fu">as.factor</span>(tint) <span class="sc">*</span> <span class="fu">as.factor</span>(wint) <span class="sc">+</span> sex <span class="sc">+</span> log2bili, </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = fail2 ~ offset(log(risktime2)) + beh + as.factor(tint) * 
    as.factor(wint) + sex + log2bili, family = poisson, data = provasplit2)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                         -4.72678    1.20626  -3.919 8.91e-05 ***
beh1                                -1.09421    0.64703  -1.691   0.0908 .  
beh2                                -0.31016    0.57923  -0.535   0.5923    
beh3                                 0.83850    0.51484   1.629   0.1034    
as.factor(tint)2                    -0.74368    1.06413  -0.699   0.4846    
as.factor(tint)3                   -14.39376 1275.75399  -0.011   0.9910    
as.factor(wint)2                    -1.03184    0.79349  -1.300   0.1935    
as.factor(wint)3                    -3.37183    0.51906  -6.496 8.24e-11 ***
sex                                  0.77074    0.50839   1.516   0.1295    
log2bili                             0.21347    0.18999   1.124   0.2612    
as.factor(tint)2:as.factor(wint)2    1.26419    1.62046   0.780   0.4353    
as.factor(tint)3:as.factor(wint)2    1.03184 1804.18859   0.001   0.9995    
as.factor(tint)2:as.factor(wint)3    0.08176    1.23780   0.066   0.9473    
as.factor(tint)3:as.factor(wint)3   13.70295 1275.75414   0.011   0.9914    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 237.84  on 160  degrees of freedom
Residual deviance: 158.93  on 147  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 240.93

Number of Fisher Scoring iterations: 13</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT for time-dependent covariates</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>glmboth<span class="ot">&lt;-</span><span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">relevel</span>(<span class="fu">as.factor</span>(wint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">relevel</span>(<span class="fu">as.factor</span>(tint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>               sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>glmwint<span class="ot">&lt;-</span><span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">relevel</span>(<span class="fu">as.factor</span>(wint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>               sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>glmtint<span class="ot">&lt;-</span><span class="fu">glm</span>(fail2 <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(risktime2)) <span class="sc">+</span> beh <span class="sc">+</span> </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">relevel</span>(<span class="fu">as.factor</span>(tint), <span class="at">ref =</span> <span class="st">"3"</span>) <span class="sc">+</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>               sex <span class="sc">+</span> log2bili, <span class="at">data =</span> provasplit2, <span class="at">family =</span> poisson)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT effect of duration since bleeding</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(glmtint,glmboth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(tint), 
    ref = "3") + sex + log2bili
Model 2: fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(wint), 
    ref = "3") + relevel(as.factor(tint), ref = "3") + sex + 
    log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   8 -128.47                         
2  10 -107.11  2 42.736  5.248e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT effect of time since randomization</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(glmwint,glmboth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(wint), 
    ref = "3") + sex + log2bili
Model 2: fail2 ~ offset(log(risktime2)) + beh + relevel(as.factor(wint), 
    ref = "3") + relevel(as.factor(tint), ref = "3") + sex + 
    log2bili
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   8 -108.08                     
2  10 -107.11  2 1.9499     0.3772</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.10-sas_cdaa592587bcd3f5cfbadef91f1c2636">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (a);</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>proc genmod data<span class="ot">=</span>provasplit1;</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) wint;</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    model fail<span class="ot">=</span>beh wint sex log2bili<span class="sc">/</span>dist<span class="ot">=</span>poi offset<span class="ot">=</span>logrisk type3;</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (b);</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>proc genmod data<span class="ot">=</span>provasplit2;</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) tint;</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    model fail2<span class="ot">=</span>beh tint sex log2bili<span class="sc">/</span>dist<span class="ot">=</span>poi offset<span class="ot">=</span>logrisk2 type3;</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (c);</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>proc genmod data<span class="ot">=</span>provasplit2;</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) wint tint;</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>    model fail2<span class="ot">=</span>beh wint tint sex log2bili<span class="sc">/</span>dist<span class="ot">=</span>poi offset<span class="ot">=</span>logrisk2 type3;</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Interaction model, <span class="cf">in</span><span class="sc">-</span>text;</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>proc genmod data<span class="ot">=</span>provasplit2;</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">beh</span> (<span class="at">ref=</span><span class="st">'0'</span>) wint tint;</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>    model fail2<span class="ot">=</span>beh wint tint wint<span class="sc">*</span>tint sex log2bili<span class="sc">/</span>dist<span class="ot">=</span>poi offset<span class="ot">=</span>logrisk2 type3;</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.13" class="level3">
<h3 class="anchored" data-anchor-id="table-3.13">Table 3.13</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.13-r_c49f788a05b6a20f8aa8456b4252ebce">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data set for analysis - double</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>double1 <span class="ot">&lt;-</span> provany <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">time =</span> d0time, </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">status =</span> dead0, </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">entrytime =</span> <span class="dv">0</span>, </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sex1 =</span> sex, </span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sex2 =</span> <span class="dv">0</span>, </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">age1 =</span> age, </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">age2 =</span> <span class="dv">0</span>, </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bili1 =</span> log2bili, </span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bili2 =</span> log2bili <span class="sc">*</span> <span class="dv">0</span>,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bleeding =</span> <span class="dv">1</span>)</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>double2 <span class="ot">&lt;-</span> provany <span class="sc">%&gt;%</span> <span class="fu">filter</span>(bleed <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">time =</span> bdtime, </span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">status =</span> deadb, </span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">entrytime =</span> btime, </span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sex1 =</span> <span class="dv">0</span>, </span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sex2 =</span> sex, </span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">age1 =</span> <span class="dv">0</span>, </span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">age2 =</span> age, </span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bili1 =</span> log2bili <span class="sc">*</span> <span class="dv">0</span>, </span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bili2 =</span> log2bili,</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bleeding =</span> <span class="dv">2</span>)</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>double <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(double1, double2))</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a><span class="co"># part (a)</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>a <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="fu">strata</span>(bleeding) <span class="sc">+</span> sex1 <span class="sc">+</span> sex2 <span class="sc">+</span> bili1 <span class="sc">+</span> bili2, </span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entrytime, time, status != 0) ~ strata(bleeding) + 
    sex1 + sex2 + bili1 + bili2, data = double, ties = "breslow")

         coef exp(coef) se(coef)      z        p
sex1   1.0408    2.8316   0.4110  2.532   0.0113
sex2   0.9095    2.4830   0.4807  1.892   0.0585
bili1  0.5275    1.6947   0.1152  4.580 4.64e-06
bili2 -0.1618    0.8506   0.1826 -0.886   0.3758

Likelihood ratio test=32.5  on 4 df, p=1.509e-06
n= 323, number of events= 73 
   (13 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part (b)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>b <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="fu">strata</span>(bleeding) <span class="sc">+</span> sex <span class="sc">+</span> bili1 <span class="sc">+</span> bili2, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entrytime, time, status != 0) ~ strata(bleeding) + 
    sex + bili1 + bili2, data = double, ties = "breslow")

         coef exp(coef) se(coef)      z        p
sex    0.9866    2.6820   0.3115  3.167  0.00154
bili1  0.5269    1.6936   0.1150  4.582 4.61e-06
bili2 -0.1685    0.8449   0.1794 -0.939  0.34767

Likelihood ratio test=32.46  on 3 df, p=4.185e-07
n= 323, number of events= 73 
   (13 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LRT sex</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(Table3<span class="fl">.13</span>b,Table3<span class="fl">.13</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(entrytime, time, status != 0) ~ strata(bleeding) + sex + 
    bili1 + bili2
Model 2: Surv(entrytime, time, status != 0) ~ strata(bleeding) + sex1 + 
    sex2 + bili1 + bili2
  #Df  LogLik Df Chisq Pr(&gt;Chisq)
1   3 -288.94                    
2   4 -288.92  1 0.043     0.8357</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In-text: LRT log2(bilirubin)</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>bx <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="fu">strata</span>(bleeding) <span class="sc">+</span> sex1 <span class="sc">+</span> sex2 <span class="sc">+</span> log2bili, </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(Table3<span class="fl">.13</span>bx,Table3<span class="fl">.13</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(entrytime, time, status != 0) ~ strata(bleeding) + sex1 + 
    sex2 + log2bili
Model 2: Surv(entrytime, time, status != 0) ~ strata(bleeding) + sex1 + 
    sex2 + bili1 + bili2
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)   
1   3 -293.86                        
2   4 -288.92  1 9.8962   0.001656 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part (c)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>c <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="fu">strata</span>(bleeding) <span class="sc">+</span> sex <span class="sc">+</span> bili1, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>Table3<span class="fl">.13</span>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entrytime, time, status != 0) ~ strata(bleeding) + 
    sex + bili1, data = double, ties = "breslow")

        coef exp(coef) se(coef)     z        p
sex   0.9423    2.5659   0.3072 3.067  0.00216
bili1 0.5263    1.6927   0.1149 4.582 4.61e-06

Likelihood ratio test=31.58  on 2 df, p=1.387e-07
n= 323, number of events= 73 
   (13 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In-text: LRT proportionality</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>ph<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> bleeding <span class="sc">+</span> sex <span class="sc">+</span> bili1, </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>pht<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entrytime, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> bleeding <span class="sc">+</span> <span class="fu">tt</span>(bleeding) </span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>           <span class="sc">+</span> sex <span class="sc">+</span> bili1, </span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> double, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...){</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>             bleedt <span class="ot">=</span> x<span class="sc">*</span><span class="fu">log</span>(t)</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>           })</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(ph, pht)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(entrytime, time, status != 0) ~ bleeding + sex + bili1
Model 2: Surv(entrytime, time, status != 0) ~ bleeding + tt(bleeding) + 
    sex + bili1
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   3 -343.23                         
2   4 -335.42  1 15.615  7.764e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.13-sas_2e95b766019c6b3251e7ea236414f04b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Prepare data set <span class="cf">for</span> analysis <span class="sc">-</span> double; </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>data double; </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    set provany; </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    time<span class="ot">=</span>d0time; </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>    status<span class="ot">=</span>dead0; </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>    entrytime<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>    sex1<span class="ot">=</span>sex; </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>    sex2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    age1<span class="ot">=</span>age; </span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>    age2<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    bili1<span class="ot">=</span>log2bili; </span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    bili2<span class="ot">=</span>log2bili<span class="sc">*</span><span class="dv">0</span>; </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>    bleeding<span class="ot">=</span><span class="dv">1</span>; </span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>    output;</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bleed<span class="ot">=</span><span class="dv">1</span> then do;</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>        time<span class="ot">=</span>bdtime; </span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>        status<span class="ot">=</span>deadb; </span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>        entrytime<span class="ot">=</span>btime; </span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>        sex1<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>        sex2<span class="ot">=</span>sex;</span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>        age1<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>        age2<span class="ot">=</span>age; </span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>        bili1<span class="ot">=</span>log2bili<span class="sc">*</span><span class="dv">0</span>; </span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>        bili2<span class="ot">=</span>log2bili; </span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>        bleeding<span class="ot">=</span><span class="dv">2</span>; </span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>        output; </span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (a);</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>double;</span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>sex1 sex2 bili1 bili2 <span class="sc">/</span>entry<span class="ot">=</span>entrytime <span class="fu">type3</span>(lr);</span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>    strata bleeding;</span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>    test sex1<span class="ot">=</span>sex2; <span class="sc">/</span><span class="er">*</span> wald tests instead of LRT <span class="sc">*</span><span class="er">/</span></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a>    test bili1<span class="ot">=</span>bili2;</span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (b);</span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>double; </span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>sex bili1 bili2 <span class="sc">/</span>entry<span class="ot">=</span>entrytime <span class="fu">type3</span>(lr);</span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a>    strata bleeding;</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (c);</span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>double; </span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>sex bili1 <span class="sc">/</span>entry<span class="ot">=</span>entrytime <span class="fu">type3</span>(lr);</span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a>    strata bleeding;</span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> In<span class="sc">-</span>text<span class="sc">:</span> LRT proportionality;</span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>double; </span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a>  bleedinglogt<span class="ot">=</span>bleeding<span class="sc">*</span><span class="fu">log</span>(time);</span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>sex bili1 bleeding bleedinglogt <span class="sc">/</span>entry<span class="ot">=</span>entrytime <span class="fu">type3</span>(lr);</span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.9" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.9">Figure 3.9</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.9-r_7c2767106d6b4e919d22b9588097139a">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract cumulative hazard from r1 </span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>survr1 <span class="ot">&lt;-</span> <span class="fu">basehaz</span>(Table3<span class="fl">.13</span>a, <span class="at">center =</span> F)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>pcumhaz <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cumhaz =</span> <span class="fu">c</span>(survr1<span class="sc">$</span>hazard[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=1"</span>],<span class="dv">0</span>,survr1<span class="sc">$</span>hazard[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=2"</span>]), </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> <span class="fu">c</span>(survr1<span class="sc">$</span>time[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=1"</span>],<span class="dv">0</span>,survr1<span class="sc">$</span>time[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=2"</span>]), </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="fu">c</span>(survr1<span class="sc">$</span>strata[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=1"</span>],<span class="st">"2"</span>,survr1<span class="sc">$</span>strata[survr1<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"stratum=2"</span>])</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.9</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time <span class="sc">/</span> <span class="fl">365.25</span>, <span class="at">y =</span> cumhaz, <span class="at">linetype =</span> strata), <span class="at">data =</span> pcumhaz) <span class="sc">+</span> </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since randomization (years)"</span>) <span class="sc">+</span> </span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative hazard"</span>) <span class="sc">+</span> </span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span> </span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Stratum"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)) <span class="sc">+</span> </span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  theme_general <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.9-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.9-sas_de0aaa5daa80ce9155ba6c9a115ede25">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>data covar; </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    input sex1 sex2 bili1 bili2; </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    datalines; </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>; </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="fu">part</span> (a);</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>double;</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>sex1 sex2 bili1 bili2 <span class="sc">/</span>entry<span class="ot">=</span>entrytime <span class="fu">type3</span>(lr);</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    strata bleeding;</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>mort cumhaz<span class="ot">=</span>breslow covariates<span class="ot">=</span>covar;</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>data mort; </span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    set mort; </span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>    timeyears <span class="ot">=</span> time <span class="sc">/</span><span class="fl">365.25</span>; </span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>mort; </span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    plot breslow<span class="sc">*</span>timeyears<span class="ot">=</span>bleeding<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2;</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">4</span> by <span class="dv">1</span> minor<span class="ot">=</span>none </span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>          label<span class="ot">=</span>(<span class="st">'Time since randomization (Years)'</span>);</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">4</span> by <span class="dv">1</span> minor<span class="ot">=</span>none label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative hazard'</span>);</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;</span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="recurrent-episodes-in-affective-disorders" class="level2">
<h2 class="anchored" data-anchor-id="recurrent-episodes-in-affective-disorders">Recurrent episodes in affective disorders</h2>
<section id="read-data-4" class="level3">
<h3 class="anchored" data-anchor-id="read-data-4">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-affective_6ae6ad96ae35752743b044310e672577">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>affective <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/affective.csv"</span>))</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>affective<span class="sc">$</span>wait <span class="ot">&lt;-</span> <span class="fu">with</span>(affective, stop <span class="sc">-</span> start)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-affective-sas_21301dc9afe147f9fde9c5e9f413665a">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>proc import out<span class="ot">=</span>affective</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/affective.csv"</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    dbms<span class="ot">=</span>csv replace;</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>data affective; </span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    set affective; </span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    wait <span class="ot">=</span> stop <span class="sc">-</span> start; </span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>run; </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.6" class="level3">
<h3 class="anchored" data-anchor-id="table-3.6">Table 3.6</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.6-r_e3482e4e4629eaa2c86fa890fabb3ab9">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> bip,</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">subset</span>(affective, state <span class="sc">==</span> <span class="dv">0</span>), <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ bip, data = subset(affective, 
    state == 0), ties = "breslow")

       coef exp(coef) se(coef)     z        p
bip 0.36593   1.44186  0.09448 3.873 0.000107

Likelihood ratio test=14.24  on 1 df, p=0.0001612
n= 626, number of events= 542 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> bip <span class="sc">+</span> episode,</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">subset</span>(affective, state <span class="sc">==</span> <span class="dv">0</span>), <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ bip + episode, 
    data = subset(affective, state == 0), ties = "breslow")

            coef exp(coef) se(coef)      z        p
bip     0.318455  1.375002 0.094545  3.368 0.000756
episode 0.126230  1.134543 0.008675 14.552  &lt; 2e-16

Likelihood ratio test=177.8  on 2 df, p=&lt; 2.2e-16
n= 626, number of events= 542 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> bip <span class="sc">+</span> episode <span class="sc">+</span> <span class="fu">I</span>(episode<span class="sc">*</span>episode),</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">subset</span>(affective, state <span class="sc">==</span> <span class="dv">0</span>), <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ bip + episode + 
    I(episode * episode), data = subset(affective, state == 0), 
    ties = "breslow")

                          coef exp(coef)  se(coef)      z      p
bip                   0.066935  1.069226  0.097084  0.689  0.491
episode               0.424503  1.528831  0.032315 13.136 &lt;2e-16
I(episode * episode) -0.013617  0.986476  0.001554 -8.764 &lt;2e-16

Likelihood ratio test=283.1  on 3 df, p=&lt; 2.2e-16
n= 626, number of events= 542 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Episode as categorical</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>affective<span class="sc">$</span>epi<span class="ot">&lt;-</span><span class="fu">with</span>(affective, <span class="fu">ifelse</span>(episode<span class="sc">&lt;</span><span class="dv">10</span>,episode,<span class="dv">10</span>))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> bip <span class="sc">+</span> <span class="fu">factor</span>(epi),</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">subset</span>(affective, state <span class="sc">==</span> <span class="dv">0</span>), <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ bip + factor(epi), 
    data = subset(affective, state == 0), ties = "breslow")

                  coef exp(coef) se(coef)      z        p
bip            0.08048   1.08381  0.09723  0.828    0.408
factor(epi)2   0.85474   2.35077  0.16125  5.301 1.15e-07
factor(epi)3   1.16051   3.19155  0.18519  6.267 3.69e-10
factor(epi)4   1.38768   4.00554  0.20278  6.843 7.75e-12
factor(epi)5   1.93212   6.90414  0.21559  8.962  &lt; 2e-16
factor(epi)6   1.88500   6.58637  0.23483  8.027 9.97e-16
factor(epi)7   2.08122   8.01427  0.24693  8.429  &lt; 2e-16
factor(epi)8   2.37102  10.70835  0.26095  9.086  &lt; 2e-16
factor(epi)9   3.00076  20.10084  0.27006 11.112  &lt; 2e-16
factor(epi)10  2.85119  17.30842  0.18992 15.013  &lt; 2e-16

Likelihood ratio test=298.5  on 10 df, p=&lt; 2.2e-16
n= 626, number of events= 542 </code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.6-sas_2d7aaddb290a7aa647eab9d99642ad46">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>affective;</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    where state<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    model stop<span class="sc">*</span><span class="fu">status</span>(<span class="dv">2</span> <span class="dv">3</span>)<span class="ot">=</span> bip <span class="sc">/</span> entry<span class="ot">=</span>start rl <span class="fu">type3</span>(lr);</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>affective;</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    where state<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    model stop<span class="sc">*</span><span class="fu">status</span>(<span class="dv">2</span> <span class="dv">3</span>)<span class="ot">=</span> bip episode <span class="sc">/</span> entry<span class="ot">=</span>start rl <span class="fu">type3</span>(lr);</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Episode as categorical;</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>data affective2;</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  set affective;</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> episode<span class="sc">&gt;</span><span class="dv">10</span> the episode<span class="ot">=</span><span class="dv">10</span>;</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>affective2;</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    where state<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">episode</span>(<span class="at">ref=</span><span class="st">"1"</span>);</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>    model stop<span class="sc">*</span><span class="fu">status</span>(<span class="dv">2</span> <span class="dv">3</span>)<span class="ot">=</span> bip episode <span class="sc">/</span> entry<span class="ot">=</span>start rl <span class="fu">type3</span>(lr);</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>affective;</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>    where state<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>    model stop<span class="sc">*</span><span class="fu">status</span>(<span class="dv">2</span> <span class="dv">3</span>)<span class="ot">=</span> bip episode episode<span class="sc">*</span>episode <span class="sc">/</span> entry<span class="ot">=</span>start rl <span class="fu">type3</span>(lr);</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.7" class="level3">
<h3 class="anchored" data-anchor-id="table-3.7">Table 3.7</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.7_0f758696dfdfd2a17d7fc4ade6288a84">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> bip <span class="sc">+</span> <span class="fu">tt</span>(year),</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">subset</span>(affective, state <span class="sc">==</span> <span class="dv">0</span>), <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>         per <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">+</span> t<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">cbind</span>(<span class="at">period1=</span><span class="dv">1</span><span class="sc">*</span>(<span class="dv">66</span><span class="sc">&lt;=</span>per <span class="sc">&amp;</span> per<span class="sc">&lt;</span><span class="dv">71</span>),</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">period2=</span><span class="dv">1</span><span class="sc">*</span>(<span class="dv">71</span><span class="sc">&lt;=</span>per <span class="sc">&amp;</span> per<span class="sc">&lt;</span><span class="dv">76</span>),</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">period3=</span><span class="dv">1</span><span class="sc">*</span>(<span class="dv">76</span><span class="sc">&lt;=</span>per <span class="sc">&amp;</span> per<span class="sc">&lt;</span><span class="dv">81</span>),</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">period4=</span><span class="dv">1</span><span class="sc">*</span>(<span class="dv">81</span><span class="sc">&lt;=</span>per))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ bip + tt(year), 
    data = subset(affective, state == 0), ties = "breslow", tt = function(x, 
        t, ...) {
        per &lt;- x + 0.5 + t/12
        cbind(period1 = 1 * (66 &lt;= per &amp; per &lt; 71), period2 = 1 * 
            (71 &lt;= per &amp; per &lt; 76), period3 = 1 * (76 &lt;= per &amp; 
            per &lt; 81), period4 = 1 * (81 &lt;= per))
    })

                    coef exp(coef) se(coef)      z        p
bip              0.36123   1.43509  0.09454  3.821 0.000133
tt(year)period1 -0.25060   0.77834  0.20834 -1.203 0.229047
tt(year)period2 -0.17948   0.83570  0.33095 -0.542 0.587596
tt(year)period3 -0.36737   0.69256  0.43858 -0.838 0.402237
tt(year)period4 -1.33241   0.26384  0.55385 -2.406 0.016141

Likelihood ratio test=25.16  on 5 df, p=0.0001299
n= 626, number of events= 542 </code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.7-sas_7051b4200596cdd25c1bc39b777a406e">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>affective;</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    where state<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    model stop<span class="sc">*</span><span class="fu">status</span>(<span class="dv">2</span> <span class="dv">3</span>)<span class="ot">=</span> bip period1 period2 period3 period4 <span class="sc">/</span> entry<span class="ot">=</span>start rl <span class="fu">type3</span>(lr);</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    period<span class="ot">=</span>year<span class="fl">+0.5</span><span class="sc">+</span>stop<span class="sc">/</span><span class="dv">12</span>;</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    period1<span class="ot">=</span><span class="dv">0</span>; period2<span class="ot">=</span><span class="dv">0</span>; period3<span class="ot">=</span><span class="dv">0</span>; period4<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">71</span><span class="sc">&gt;</span>period<span class="sc">&gt;=</span><span class="dv">66</span> then period1<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">76</span><span class="sc">&gt;</span>period<span class="sc">&gt;=</span><span class="dv">71</span> then period2<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">81</span><span class="sc">&gt;</span>period<span class="sc">&gt;=</span><span class="dv">76</span> then period3<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> period<span class="sc">&gt;=</span><span class="dv">81</span> then period4<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>run</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="leader-cardiovascular-trial-in-type-2-diabetes" class="level2">
<h2 class="anchored" data-anchor-id="leader-cardiovascular-trial-in-type-2-diabetes">LEADER cardiovascular trial in type 2 diabetes</h2>
<div class="cell" data-hash="Ch3_cache/html/unnamed-chunk-42_725921218269e38231ef9bab85e6acc1">

</div>
<section id="read-data-5" class="level3">
<h3 class="anchored" data-anchor-id="read-data-5">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<p>Assume that the LEADER data set is loaded in data set <code>leader</code>.</p>
<div class="cell" data-hash="Ch3_cache/html/read-leader-r_6ea26d4c84902150f91449ec7eb9a396">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One data set per recurrent endpoint type</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>leader_mi <span class="ot">&lt;-</span> <span class="fu">subset</span>(leader, type <span class="sc">==</span> <span class="st">"recurrent_mi"</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>leader_3p <span class="ot">&lt;-</span> <span class="fu">subset</span>(leader, type <span class="sc">==</span> <span class="st">"recurrent_comb_str_mi_cvdth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.15" class="level3">
<h3 class="anchored" data-anchor-id="table-3.15">Table 3.15</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">R</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table3.15-r_cd29cd10f43038a490db4f98b1733d72">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox model, frailty</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>coxfrail <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">frailty</span>(id), </span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"breslow"</span>, </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> leader_mi)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(coxfrail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, status == 1) ~ treat + frailty(id), 
    data = leader_mi, method = "breslow")

  n= 10120, number of events= 780 

            coef    se(coef) se2     Chisq   DF   p     
treat       -0.1773 0.0877   0.07197    4.09    1 0.0430
frailty(id)                          3219.37 3030 0.0084

      exp(coef) exp(-coef) lower .95 upper .95
treat    0.8376      1.194    0.7053    0.9946

Iterations: 7 outer, 28 Newton-Raphson
     Variance of random effect= 5.686665   I-likelihood = -6863.6 
Degrees of freedom for terms=    0.7 3030.1 
Concordance= 0.975  (se = 0.001 )
Likelihood ratio test= 2841  on 3031 df,   p=1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PieceWise constant, frailty</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make cuts </span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>alltimes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(leader_mi<span class="sc">$</span>stop),<span class="at">length=</span><span class="dv">99</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>FunctionIntervalM <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq</span>(<span class="at">from=</span><span class="fu">min</span>(a), <span class="at">to =</span> <span class="fu">max</span>(a), <span class="at">by =</span> (<span class="fu">max</span>(a)<span class="sc">-</span><span class="fu">min</span>(a))<span class="sc">/</span>b)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> <span class="fu">FunctionIntervalM</span>(<span class="at">a =</span> alltimes, <span class="at">b =</span> <span class="dv">5</span>)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>cuts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    0.0  379.2  758.4 1137.6 1516.8 1896.0</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AG model, piecewise constant hazards </span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>cut_data <span class="ot">&lt;-</span> <span class="fu">survSplit</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> ., </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                      leader_mi,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cut =</span> cuts[<span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">episode =</span> <span class="st">"timegroup"</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>pwch_frail <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, event) <span class="sc">~</span> </span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>                    treat <span class="sc">+</span> <span class="fu">strata</span>(timegroup) <span class="sc">+</span> <span class="fu">frailty</span>(id), </span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> cut_data)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pwch_frail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(start, stop, event) ~ treat + strata(timegroup) + 
    frailty(id), data = cut_data)

  n= 39070, number of events= 780 

            coef    se(coef) se2     Chisq   DF   p     
treat       -0.1773 0.08772  0.07197    4.09    1 0.0430
frailty(id)                          3222.23 3033 0.0085

      exp(coef) exp(-coef) lower .95 upper .95
treat    0.8375      1.194    0.7052    0.9946

Iterations: 7 outer, 28 Newton-Raphson
     Variance of random effect= 5.694404   I-likelihood = -6863.4 
Degrees of freedom for terms=    0.7 3033.3 
Concordance= 0.975  (se = 0.001 )
Likelihood ratio test= 2843  on 3034 df,   p=1</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Joint frailty model, piecewise constant hazards</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(frailtypack)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>leader_mi<span class="sc">$</span>death <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(leader_mi<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>jointfrail_pc_eq_mi <span class="ot">&lt;-</span> <span class="fu">frailtyPenal</span>(<span class="fu">Surv</span>(start, stop, status <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">cluster</span>(id) <span class="sc">+</span> treat <span class="sc">+</span> <span class="fu">terminal</span>(death),</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">formula.terminalEvent =</span> <span class="sc">~</span> treat,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> leader_mi,</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hazard =</span> <span class="st">"Piecewise-equi"</span>, <span class="at">nb.int =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">recurrentAG =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Be patient. The program is computing ... 
The program took 222.38 seconds </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>jointfrail_pc_eq_mi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
frailtyPenal(formula = Surv(start, stop, status == 1) ~ cluster(id) + 
    treat + terminal(death), formula.terminalEvent = ~treat, 
    data = leader_mi, recurrentAG = TRUE, hazard = "Piecewise-equi", 
    nb.int = c(5, 5))


  Joint gamma frailty model for recurrent and a terminal event processes 
  using a Parametrical approach for the hazard function 

Recurrences:
------------- 
          coef exp(coef) SE coef (H)        z        p
treat -0.18591  0.830349   0.0680109 -2.73353 0.006266

Terminal event:
---------------- 
           coef exp(coef) SE coef (H)        z         p
treat -0.211397  0.809452   0.0784837 -2.69352 0.0070702

 Frailty parameters: 
   theta (variance of Frailties, w): 0.895749 (SE (H): 0.0306499 ) p = &lt; 1e-16 
   alpha (w^alpha for terminal event): 1.85978 (SE (H): 0.115069 ) p = &lt; 1e-16 
 
   marginal log-likelihood = -16965
   Convergence criteria: 
   parameters = 3.07e-08 likelihood = 0.000848 gradient = 2.12e-07 

   AIC = Aikaike information Criterion     = 1.67777 

The expression of the Aikaike Criterion is: 
        'AIC = (1/n)[np - l(.)]' 

   n observations= 10120  n subjects= 9340
   n recurrent events= 780
   n terminal events= 828
   n censored events= 9340
   number of iterations:  37 
   Number of nodes for the Gauss-Laguerre quadrature:  32 
   Exact number of time intervals used:  5 
   Exact number of time intervals used:  5 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointfrail_pc_eq_mi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Recurrences:
------------- 
           hr     95%     C.I. 
 treat   0.83 (   0.73 -   0.95 ) 

Terminal event:
--------------- 
           hr     95%     C.I. 
 treat   0.81 (   0.69 -   0.94 ) </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="bone-marrow-transplantation-in-acute-leukemia" class="level2">
<h2 class="anchored" data-anchor-id="bone-marrow-transplantation-in-acute-leukemia">Bone marrow transplantation in acute leukemia</h2>
<section id="read-data-6" class="level3">
<h3 class="anchored" data-anchor-id="read-data-6">Read data</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell" data-hash="Ch3_cache/html/read-bmt-r_cf6df7041c8b7c3812c6f0f673e60609">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>bmt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">read.csv</span>(<span class="st">"data/bmt.csv"</span>))</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>intxsurv<span class="ot">&lt;-</span> bmt<span class="sc">$</span>timedeath</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>intxrel <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bmt<span class="sc">$</span>rel <span class="sc">==</span> <span class="dv">1</span>, bmt<span class="sc">$</span>timerel, bmt<span class="sc">$</span>timedeath)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>trm     <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bmt<span class="sc">$</span>rel <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> bmt<span class="sc">$</span>death <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>tgvhd   <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bmt<span class="sc">$</span>gvhd <span class="sc">==</span> <span class="dv">1</span>, bmt<span class="sc">$</span>timegvhd, bmt<span class="sc">$</span>intxrel)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>tanc500 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bmt<span class="sc">$</span>anc500 <span class="sc">==</span> <span class="dv">1</span>, bmt<span class="sc">$</span>timeanc500, bmt<span class="sc">$</span>intxrel)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>state0  <span class="ot">&lt;-</span> bmt<span class="sc">$</span>rel <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>bmt<span class="sc">$</span>trm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell" data-hash="Ch3_cache/html/read-bmt-sas_785ed1dd85e7eaf9818545dccb6b06f9">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>proc import out<span class="ot">=</span>bmt</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>    datafile<span class="ot">=</span><span class="st">"data/bmt.csv"</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>    dbms<span class="ot">=</span>csv replace;</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>data bmt; </span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    set bmt;</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    intxsurv<span class="ot">=</span>timedeath; dead<span class="ot">=</span>death;</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rel<span class="ot">=</span><span class="dv">1</span> then intxrel<span class="ot">=</span>timerel; <span class="cf">if</span> rel<span class="ot">=</span><span class="dv">0</span> then intxrel<span class="ot">=</span>timedeath;</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    trm<span class="ot">=</span><span class="dv">0</span>; <span class="cf">if</span> rel<span class="ot">=</span><span class="dv">0</span> and death<span class="ot">=</span><span class="dv">1</span> then trm<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    state0<span class="ot">=</span>rel<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>trm;</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> then tgvhd<span class="ot">=</span>timegvhd; <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">0</span> then tgvhd<span class="ot">=</span>intxrel;</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.5" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.5">Figure 3.5</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.5-r_44908f0a65b26ef57dd5264eb9adf2dc">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># General theme</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>theme_general <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) </span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit and make plot data</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tgvhd, gvhd <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bmt)</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>pdata1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit1<span class="sc">$</span>cumhaz, </span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">time =</span> fit1<span class="sc">$</span>time) </span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.5</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata1) <span class="sc">+</span> </span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since bone marrow transplantation (months)"</span>) <span class="sc">+</span> </span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative GvHD hazard"</span>) <span class="sc">+</span> </span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">156</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">156</span>, <span class="at">by =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.5-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.5-sas_bc35cdc0fe433d467fa333a57d4d5a60">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>    model tgvhd<span class="sc">*</span><span class="fu">gvhd</span>(<span class="dv">0</span>)<span class="ot">=</span>;</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfagvh cumhaz<span class="ot">=</span>naagvh;</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>alfagvh;</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>    plot naagvh<span class="sc">*</span>tgvhd<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2;</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">156</span> by <span class="dv">12</span> minor<span class="ot">=</span>none</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="st">'Time since bone marrow transplantation (months)'</span>);</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.8</span> by <span class="fl">0.1</span> minor<span class="ot">=</span>none</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative GvHD hazard'</span>);</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.6" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.6">Figure 3.6</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.6-r_690ffaf1fd934f5eef825cec017480fb">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reformatting</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>nyreltime <span class="ot">&lt;-</span> <span class="fu">with</span>(bmt, <span class="fu">ifelse</span>(tgvhd <span class="sc">&lt;</span> intxrel, tgvhd, intxrel))</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>nyrel <span class="ot">&lt;-</span> <span class="fu">with</span>(bmt, <span class="fu">ifelse</span>(tgvhd <span class="sc">&lt;</span> intxrel, <span class="dv">0</span>, rel))</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>nytrm <span class="ot">&lt;-</span> <span class="fu">with</span>(bmt, <span class="fu">ifelse</span>(tgvhd <span class="sc">&lt;</span> intxrel, <span class="dv">0</span>, trm))</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative relapse rate without GvHD </span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>fit11 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(nyreltime, nyrel <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bmt)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative relapse rate after GvHD</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>fit12 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tgvhd, intxrel, rel <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">subset</span>(bmt, gvhd <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tgvhd <span class="sc">&lt;</span> intxrel))</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect plot data</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>pdata11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit11<span class="sc">$</span>cumhaz, <span class="at">time =</span> fit11<span class="sc">$</span>time) </span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>pdata12 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit12<span class="sc">$</span>cumhaz, <span class="at">time =</span> fit12<span class="sc">$</span>time) </span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.6</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata11) <span class="sc">+</span> </span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata12, </span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since bone marrow transplantation (months)"</span>) <span class="sc">+</span> </span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative relapse hazard"</span>) <span class="sc">+</span> </span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">156</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">156</span>, <span class="at">by =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.6-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.6-sas_23a8135d475ab91c6ce26e3946f8290c">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Reformatting; </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>data bmt; </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>set bmt; <span class="sc">/</span><span class="er">*</span> Censor at GvHD <span class="sc">*</span><span class="er">/</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tgvhd<span class="sc">&lt;</span>intxrel then do;</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    nyreltime<span class="ot">=</span>tgvhd; nyrel<span class="ot">=</span><span class="dv">0</span>; nytrm<span class="ot">=</span><span class="dv">0</span>; end;</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tgvhd<span class="ot">=</span>intxrel then do;</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>    nyreltime<span class="ot">=</span>intxrel; nyrel<span class="ot">=</span>rel; nytrm<span class="ot">=</span>trm; end;</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Cumulative relapse rate without gvhd; </span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>    model nyreltime<span class="sc">*</span><span class="fu">nyrel</span>(<span class="dv">0</span>)<span class="ot">=</span>;</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfa0rel cumhaz<span class="ot">=</span>naa0rel;</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Cumulative relapse rate after gvhd; </span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>    where gvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">rel</span>(<span class="dv">0</span>)<span class="ot">=</span><span class="er">/</span>entry<span class="ot">=</span>tgvhd;</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfagvhrel cumhaz<span class="ot">=</span>naagvhrel;</span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>data alfa0rel; </span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>    set alfa0rel; </span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>    reltime<span class="ot">=</span>nyreltime; </span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a>data alfagvhrel; </span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>    set alfagvhrel; </span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>    reltime<span class="ot">=</span>intxrel; </span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a>data rel; </span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a>    merge alfa0rel alfagvhrel; </span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a>    by reltime; </span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a>data relrev; </span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a>    set rel;</span>
<span id="cb177-36"><a href="#cb177-36" aria-hidden="true" tabindex="-1"></a>    by reltime;</span>
<span id="cb177-37"><a href="#cb177-37" aria-hidden="true" tabindex="-1"></a>    retain last1 last2;</span>
<span id="cb177-38"><a href="#cb177-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naa0rel<span class="ot">=</span>. then a02<span class="ot">=</span>last1; <span class="cf">if</span> naa0rel ne . then a02<span class="ot">=</span>naa0rel; </span>
<span id="cb177-39"><a href="#cb177-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naagvhrel<span class="ot">=</span>. then a13<span class="ot">=</span>last2; <span class="cf">if</span> naagvhrel ne . then a13<span class="ot">=</span>naagvhrel;</span>
<span id="cb177-40"><a href="#cb177-40" aria-hidden="true" tabindex="-1"></a>    output;</span>
<span id="cb177-41"><a href="#cb177-41" aria-hidden="true" tabindex="-1"></a>    last1<span class="ot">=</span>a02; last2<span class="ot">=</span>a13; </span>
<span id="cb177-42"><a href="#cb177-42" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-43"><a href="#cb177-43" aria-hidden="true" tabindex="-1"></a>legend1 label<span class="ot">=</span>none;</span>
<span id="cb177-44"><a href="#cb177-44" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>relrev;</span>
<span id="cb177-45"><a href="#cb177-45" aria-hidden="true" tabindex="-1"></a>    plot a02<span class="sc">*</span>reltime a13<span class="sc">*</span>reltime<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2 overlay legend<span class="ot">=</span>legend1;</span>
<span id="cb177-46"><a href="#cb177-46" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">156</span> by <span class="dv">12</span> minor<span class="ot">=</span>none</span>
<span id="cb177-47"><a href="#cb177-47" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="st">'Time since bone marrow transplantation (months)'</span>);</span>
<span id="cb177-48"><a href="#cb177-48" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.2</span> by <span class="fl">0.1</span> minor<span class="ot">=</span>none</span>
<span id="cb177-49"><a href="#cb177-49" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative relapse hazard'</span>);</span>
<span id="cb177-50"><a href="#cb177-50" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;</span>
<span id="cb177-51"><a href="#cb177-51" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb177-52"><a href="#cb177-52" aria-hidden="true" tabindex="-1"></a>    label a02<span class="ot">=</span><span class="st">"No GvHD"</span>;</span>
<span id="cb177-53"><a href="#cb177-53" aria-hidden="true" tabindex="-1"></a>    label a13<span class="ot">=</span><span class="st">"After GvHD"</span>;</span>
<span id="cb177-54"><a href="#cb177-54" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb177-55"><a href="#cb177-55" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.7" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.7">Figure 3.7</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.7-r_11b1688ab420f6b0cbd716d3588c3fe3">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to get the cumulative hazard estimates at the same time points</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># All times</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>all_t <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">unique</span>(pdata11<span class="sc">$</span>time), <span class="fu">unique</span>(pdata12<span class="sc">$</span>time))))</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate each step function at these time points </span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>step11 <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(<span class="at">x =</span> pdata11<span class="sc">$</span>time, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, pdata11<span class="sc">$</span>cumhaz))</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>step12 <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(<span class="at">x =</span> pdata12<span class="sc">$</span>time, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, pdata12<span class="sc">$</span>cumhaz))</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>pdata11_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> all_t, </span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumhaz =</span> <span class="fu">step11</span>(all_t))</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>pdata12_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> all_t, </span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumhaz =</span> <span class="fu">step12</span>(all_t))</span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect data</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>pdata_b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz1 =</span> pdata11_a<span class="sc">$</span>cumhaz, </span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cumhaz2 =</span> pdata12_a<span class="sc">$</span>cumhaz, </span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> all_t)</span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Make zeros print as "0" always in plots</span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>prettyZero <span class="ot">&lt;-</span> <span class="cf">function</span>(l){</span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>  max.decimals <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">nchar</span>(<span class="fu">str_extract</span>(l, <span class="st">"</span><span class="sc">\\</span><span class="st">.[0-9]+"</span>)), <span class="at">na.rm =</span> T)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>  lnew <span class="ot">=</span> <span class="fu">formatC</span>(l, <span class="at">replace.zero =</span> T, <span class="at">zero.print =</span> <span class="st">"0"</span>,</span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits =</span> max.decimals, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">preserve.width=</span>T)</span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lnew)</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.7</span></span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cumhaz1, <span class="at">y =</span> cumhaz2), <span class="at">data =</span> pdata_b) <span class="sc">+</span> </span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="fl">0.858</span>), <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Cumulative relapse hazard: no GvHD"</span>) <span class="sc">+</span> </span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative relapse hazard: GvHD"</span>) <span class="sc">+</span> </span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.05</span>),</span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> prettyZero) <span class="sc">+</span> </span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb178-36"><a href="#cb178-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.05</span>),</span>
<span id="cb178-37"><a href="#cb178-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> prettyZero) <span class="sc">+</span></span>
<span id="cb178-38"><a href="#cb178-38" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb178-39"><a href="#cb178-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-40"><a href="#cb178-40" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.7-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.7-sas_7dbce468311fc1cc38fb2d3e49b4e045">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>data relrev; </span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>    set relrev;</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>    line<span class="ot">=</span><span class="fl">0.858</span><span class="sc">*</span>a02;</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>relrev;</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    plot a13<span class="sc">*</span>a02 line<span class="sc">*</span>a02<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2 overlay;</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.2</span> by <span class="fl">0.05</span> minor<span class="ot">=</span>none </span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="st">'Cumulative relapse hazard: no GvHD'</span>);</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.2</span> by <span class="fl">0.05</span> minor<span class="ot">=</span>none </span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative relapse hazard: GvHD'</span>);</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>rl c<span class="ot">=</span>blue;</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="in-text-gvhd-as-time-dependent-covariate" class="level3">
<h3 class="anchored" data-anchor-id="in-text-gvhd-as-time-dependent-covariate">In-text: GvHD as time-dependent covariate</h3>
<section id="relapse" class="level4">
<h4 class="anchored" data-anchor-id="relapse">Relapse</h4>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-tGvHD-relapse-r_44d5e4ada84d7f69f1e2e452b6741f7b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,rel<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd), <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>      }),<span class="at">exp=</span>T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  term      estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 tt(tgvhd)    0.858     0.132     -1.15   0.248    0.663      1.11</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test ph</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,rel<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd), <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdc=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>),<span class="at">tdc_logt=</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span><span class="fu">log</span>(t<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>      }),<span class="at">exp=</span>T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term              estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 tt(tgvhd)tdc         0.599     0.409    -1.25    0.210    0.268      1.34
2 tt(tgvhd)tdc_logt    1.18      0.175     0.936   0.349    0.836      1.66</code></pre>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-tGvHD-relapse-sas_a04a66df355c3203a6763935516d9236">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">rel</span>(<span class="dv">0</span>)<span class="ot">=</span> ttgvhd <span class="sc">/</span> rl <span class="fu">type3</span>(lr);</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>    ttgvhd<span class="ot">=</span>(intxrel<span class="sc">-</span>tgvhd)<span class="sc">&gt;</span><span class="dv">0</span>;</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> test ph;</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">rel</span>(<span class="dv">0</span>)<span class="ot">=</span> ttgvhd ttgvhdlogt <span class="sc">/</span> rl <span class="fu">type3</span>(lr);</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>    ttgvhd<span class="ot">=</span>(intxrel<span class="sc">-</span>tgvhd)<span class="sc">&gt;</span><span class="dv">0</span>;</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>    ttgvhdlogt<span class="ot">=</span>ttgvhd<span class="sc">*</span><span class="fu">log</span>(intxrel<span class="sc">+</span><span class="dv">1</span>);</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="death-in-remission" class="level4">
<h4 class="anchored" data-anchor-id="death-in-remission">Death in remission</h4>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-tGvHD-death-r_855d5d9c91d1610eb0c61ab3425e9e3f">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,trm<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd), <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>      }), <span class="at">exp=</span>T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  term      estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 tt(tgvhd)     3.11    0.0964      11.8 4.88e-32     2.58      3.76</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test ph</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,trm<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd), <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdc=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>),<span class="at">tdc_logt=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span><span class="fu">log</span>(t<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>      }), <span class="at">exp=</span>T, <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term              estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 tt(tgvhd)tdc         4.10     0.197       7.18 6.99e-13    2.79       6.03
2 tt(tgvhd)tdc_logt    0.872    0.0851     -1.61 1.07e- 1    0.738      1.03</code></pre>
</div>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-tGvHD-death-sas_b1c3ae43bf3f40f41f45a48e59889061">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span> ttgvhd <span class="sc">/</span> rl <span class="fu">type3</span>(lr);</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>    ttgvhd<span class="ot">=</span>(intxrel<span class="sc">-</span>tgvhd)<span class="sc">&gt;</span><span class="dv">0</span>;</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> test ph;</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span> ttgvhd ttgvhdlogt <span class="sc">/</span> rl <span class="fu">type3</span>(lr);</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    ttgvhd<span class="ot">=</span>(intxrel<span class="sc">-</span>tgvhd)<span class="sc">&gt;</span><span class="dv">0</span>;</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    ttgvhdlogt<span class="ot">=</span>ttgvhd<span class="sc">*</span><span class="fu">log</span>(intxrel<span class="sc">+</span><span class="dv">1</span>);</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="figure-3.8" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.8">Figure 3.8</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.8-r_b9e5b049f249bbd4053fb31ccb9846cb">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death rate without GvHD </span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>fit11 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(nyreltime, nytrm <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bmt)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death rate with GvHD</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>fit12 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tgvhd, intxrel, trm <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">subset</span>(bmt, gvhd <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tgvhd <span class="sc">&lt;</span> intxrel))</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect plot data</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>pdata11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit11<span class="sc">$</span>cumhaz, </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> fit11<span class="sc">$</span>time) </span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>pdata12 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit12<span class="sc">$</span>cumhaz, </span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> fit12<span class="sc">$</span>time) </span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to get the cumulative hazard estimates at the same time points</span></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="co"># All times</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>all_t <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">unique</span>(pdata11<span class="sc">$</span>time), <span class="fu">unique</span>(pdata12<span class="sc">$</span>time))))</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate each step function at these time points </span></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>step11 <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(<span class="at">x =</span> pdata11<span class="sc">$</span>time, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, pdata11<span class="sc">$</span>cumhaz))</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>step12 <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(<span class="at">x =</span> pdata12<span class="sc">$</span>time, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, pdata12<span class="sc">$</span>cumhaz))</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>pdata11_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> all_t, </span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumhaz =</span> <span class="fu">step11</span>(all_t))</span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a>pdata12_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> all_t, </span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumhaz =</span> <span class="fu">step12</span>(all_t))</span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect data</span></span>
<span id="cb190-30"><a href="#cb190-30" aria-hidden="true" tabindex="-1"></a>pdata_b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz1 =</span> pdata11_a<span class="sc">$</span>cumhaz, </span>
<span id="cb190-31"><a href="#cb190-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cumhaz2 =</span> pdata12_a<span class="sc">$</span>cumhaz, </span>
<span id="cb190-32"><a href="#cb190-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> all_t)</span>
<span id="cb190-33"><a href="#cb190-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-34"><a href="#cb190-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.8</span></span>
<span id="cb190-35"><a href="#cb190-35" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cumhaz1, <span class="at">y =</span> cumhaz2), <span class="at">data =</span> pdata_b) <span class="sc">+</span> </span>
<span id="cb190-36"><a href="#cb190-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-37"><a href="#cb190-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="fl">3.113</span>), </span>
<span id="cb190-38"><a href="#cb190-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb190-39"><a href="#cb190-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Cumulative death hazard: no GvHD"</span>) <span class="sc">+</span> </span>
<span id="cb190-40"><a href="#cb190-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative death hazard: GvHD"</span>) <span class="sc">+</span> </span>
<span id="cb190-41"><a href="#cb190-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb190-42"><a href="#cb190-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.05</span>),</span>
<span id="cb190-43"><a href="#cb190-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> prettyZero) <span class="sc">+</span> </span>
<span id="cb190-44"><a href="#cb190-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb190-45"><a href="#cb190-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1.0</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb190-46"><a href="#cb190-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> prettyZero) <span class="sc">+</span></span>
<span id="cb190-47"><a href="#cb190-47" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb190-48"><a href="#cb190-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-49"><a href="#cb190-49" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.8-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.8-sas_461db951854d4faf46d7e26db40f3feb">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Cumulative death rate without gvhd; </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt; </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    model nyreltime<span class="sc">*</span><span class="fu">nytrm</span>(<span class="dv">0</span>)<span class="ot">=</span>;</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfa0dead cumhaz<span class="ot">=</span>naa0dead;</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Cumulative death rate with gvhd; </span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    where gvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span><span class="er">/</span>entry<span class="ot">=</span>tgvhd;</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfagvhdead cumhaz<span class="ot">=</span>naagvhdead;</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Book<span class="sc">-</span>keeping <span class="cf">for</span> plot;</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>data alfa0dead; </span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>    set alfa0dead; </span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>    deadtime<span class="ot">=</span>nyreltime; </span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>data alfagvhdead; </span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>    set alfagvhdead; </span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    deadtime<span class="ot">=</span>intxrel; </span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>data dead; </span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>    merge alfa0dead alfagvhdead; </span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>    by deadtime; </span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>data deadrev; </span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>    set dead;</span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>    by deadtime;</span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>    retain last1 last2;</span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naa0dead<span class="ot">=</span>. then a02<span class="ot">=</span>last1; <span class="cf">if</span> naa0dead ne . then a02<span class="ot">=</span>naa0dead; </span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naagvhdead<span class="ot">=</span>. then a13<span class="ot">=</span>last2; <span class="cf">if</span> naagvhdead ne . then a13<span class="ot">=</span>naagvhdead;</span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>    output;</span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>    last1<span class="ot">=</span>a02; last2<span class="ot">=</span>a13; </span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Add coefficient; </span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a>data deadrev; </span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>    set deadrev;</span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a>    line<span class="ot">=</span><span class="fl">3.113</span><span class="sc">*</span>a02;</span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>deadrev;</span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a>    plot a13<span class="sc">*</span>a02 line<span class="sc">*</span>a02<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2 overlay;</span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.2</span> by <span class="fl">0.05</span> minor<span class="ot">=</span>none</span>
<span id="cb191-42"><a href="#cb191-42" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="st">'Cumulative death hazard: no GvHD'</span>);</span>
<span id="cb191-43"><a href="#cb191-43" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">1</span> by <span class="fl">0.2</span> minor<span class="ot">=</span>none</span>
<span id="cb191-44"><a href="#cb191-44" aria-hidden="true" tabindex="-1"></a>    label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative death hazard: GvHD'</span>);</span>
<span id="cb191-45"><a href="#cb191-45" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;</span>
<span id="cb191-46"><a href="#cb191-46" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>rl c<span class="ot">=</span>blue;;</span>
<span id="cb191-47"><a href="#cb191-47" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb191-48"><a href="#cb191-48" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.4" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.4">Figure 3.4</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.4-r_73f39d03045d2e87e31ecb9b15a35c0e">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death hazards wrt relapse; </span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death rate no relapse or GvHD</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>fit11 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(intxrel, trm <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bmt)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death rate after relapse</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>bmt<span class="sc">$</span>intxsurv <span class="ot">&lt;-</span> <span class="fu">with</span>(bmt, <span class="fu">ifelse</span>(intxrel <span class="sc">==</span> intxsurv <span class="sc">&amp;</span> rel <span class="sc">==</span> <span class="dv">1</span>, intxsurv <span class="sc">+</span> <span class="fl">0.01</span>, intxsurv))</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>fit12 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(intxrel, intxsurv, death <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">subset</span>(bmt, rel <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative death rate after GvHD</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>fit13 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tgvhd, intxrel, trm <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">subset</span>(bmt, gvhd <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect plot data</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>pdata11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit11<span class="sc">$</span>cumhaz, <span class="at">time =</span> fit11<span class="sc">$</span>time) </span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>pdata12 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit12<span class="sc">$</span>cumhaz, <span class="at">time =</span> fit12<span class="sc">$</span>time) </span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>pdata13 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> fit13<span class="sc">$</span>cumhaz, <span class="at">time =</span> fit13<span class="sc">$</span>time) </span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(pdata12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      cumhaz   time
220 7.557091  84.70
221 7.557091  85.43
222 7.557091  96.41
223 8.057091  99.80
224 8.057091  99.87
225 8.057091 105.10</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.4</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata11) <span class="sc">+</span> </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata12, </span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz), <span class="at">data =</span> pdata13, </span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> </span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since bone marrow transplantation (months)"</span>) <span class="sc">+</span> </span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative hazard of death"</span>) <span class="sc">+</span> </span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">156</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">156</span>, <span class="at">by =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>  theme_general</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.4-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.4-sas_0df606373e0a7b66f9012e85834de7e2">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Cumulative death hazards wrt relapse ;</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt; </span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span>;</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfa02 cumhaz<span class="ot">=</span>naa02;</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>data bmt; </span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>    set bmt; </span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> intxrel eq intxsurv and rel eq <span class="dv">1</span> then intxsurv <span class="ot">=</span> intxsurv <span class="sc">+</span> <span class="fl">0.01</span>; </span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>    where rel<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>    model intxsurv<span class="sc">*</span><span class="fu">dead</span>(<span class="dv">0</span>)<span class="ot">=</span><span class="er">/</span>entry<span class="ot">=</span>intxrel;</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>alfa13 cumhaz<span class="ot">=</span>naa13;</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Book<span class="sc">-</span>keeping; </span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>data alfa02; </span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>    set alfa02; </span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>    deadtime<span class="ot">=</span>intxrel; </span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>data alfa13; </span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>    set alfa13; </span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>    deadtime<span class="ot">=</span>intxsurv; </span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a>data alfadead; </span>
<span id="cb195-26"><a href="#cb195-26" aria-hidden="true" tabindex="-1"></a>    merge alfa02 alfa13; </span>
<span id="cb195-27"><a href="#cb195-27" aria-hidden="true" tabindex="-1"></a>    by deadtime; </span>
<span id="cb195-28"><a href="#cb195-28" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-29"><a href="#cb195-29" aria-hidden="true" tabindex="-1"></a>data alfarev; set alfadead;</span>
<span id="cb195-30"><a href="#cb195-30" aria-hidden="true" tabindex="-1"></a>    by deadtime;</span>
<span id="cb195-31"><a href="#cb195-31" aria-hidden="true" tabindex="-1"></a>    retain last1 last2;</span>
<span id="cb195-32"><a href="#cb195-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naa02<span class="ot">=</span>. then a0rel<span class="ot">=</span>last1; <span class="cf">if</span> naa02 ne . then a0rel<span class="ot">=</span>naa02; </span>
<span id="cb195-33"><a href="#cb195-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> naa13<span class="ot">=</span>. then arel<span class="ot">=</span>last2; <span class="cf">if</span> naa13 ne . then arel<span class="ot">=</span>naa13;</span>
<span id="cb195-34"><a href="#cb195-34" aria-hidden="true" tabindex="-1"></a>    output;</span>
<span id="cb195-35"><a href="#cb195-35" aria-hidden="true" tabindex="-1"></a>    last1<span class="ot">=</span>a0rel; last2<span class="ot">=</span>arel; </span>
<span id="cb195-36"><a href="#cb195-36" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-37"><a href="#cb195-37" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="dv">3</span> mortality rates simultaneously;</span>
<span id="cb195-38"><a href="#cb195-38" aria-hidden="true" tabindex="-1"></a>data alfa3dead; </span>
<span id="cb195-39"><a href="#cb195-39" aria-hidden="true" tabindex="-1"></a>    merge deadrev alfarev; </span>
<span id="cb195-40"><a href="#cb195-40" aria-hidden="true" tabindex="-1"></a>    by deadtime; </span>
<span id="cb195-41"><a href="#cb195-41" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-42"><a href="#cb195-42" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>alfa3dead;</span>
<span id="cb195-43"><a href="#cb195-43" aria-hidden="true" tabindex="-1"></a>    plot arel<span class="sc">*</span>deadtime a02<span class="sc">*</span>deadtime a13<span class="sc">*</span>deadtime</span>
<span id="cb195-44"><a href="#cb195-44" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">/</span> overlay haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2 legend<span class="ot">=</span>legend1;</span>
<span id="cb195-45"><a href="#cb195-45" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">120</span> by <span class="dv">10</span> minor<span class="ot">=</span>none</span>
<span id="cb195-46"><a href="#cb195-46" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="st">'Time since bone marrow transplantation (months)'</span>);</span>
<span id="cb195-47"><a href="#cb195-47" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">9</span> by <span class="dv">1</span> minor<span class="ot">=</span>none</span>
<span id="cb195-48"><a href="#cb195-48" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative hazard of death'</span>);</span>
<span id="cb195-49"><a href="#cb195-49" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb195-50"><a href="#cb195-50" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;</span>
<span id="cb195-51"><a href="#cb195-51" aria-hidden="true" tabindex="-1"></a>    symbol3  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>black;</span>
<span id="cb195-52"><a href="#cb195-52" aria-hidden="true" tabindex="-1"></a>    label arel<span class="ot">=</span><span class="st">"After relapse"</span>;</span>
<span id="cb195-53"><a href="#cb195-53" aria-hidden="true" tabindex="-1"></a>    label a02<span class="ot">=</span><span class="st">"No relapse and no GvHD"</span>;</span>
<span id="cb195-54"><a href="#cb195-54" aria-hidden="true" tabindex="-1"></a>    label a13<span class="ot">=</span><span class="st">"After GvHD"</span>;</span>
<span id="cb195-55"><a href="#cb195-55" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb195-56"><a href="#cb195-56" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.12" class="level3">
<h3 class="anchored" data-anchor-id="table-3.12">Table 3.12</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.12-r_ffe7c72f5196a32047eaa1ac6f377523">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relapse</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 1</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,rel<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd) <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> bmonly <span class="sc">+</span> all,</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, rel != 0) ~ tt(tgvhd) + I(age/10) + 
    bmonly + all, data = bmt, ties = "breslow", tt = function(x, 
    t, ...) {
    dt &lt;- t - x
    cbind(tdcgvhd = 1 * (dt &gt; 0))
})

              coef exp(coef) se(coef)      z        p
tt(tgvhd) -0.18363   0.83225  0.13370 -1.373    0.170
I(age/10) -0.03973   0.96105  0.04450 -0.893    0.372
bmonly    -0.12543   0.88211  0.13504 -0.929    0.353
all        0.56273   1.75546  0.12965  4.340 1.42e-05

Likelihood ratio test=22.52  on 4 df, p=0.0001578
n= 2009, number of events= 259 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 2</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,rel<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span>  <span class="fu">tt</span>(tgvhd) <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> bmonly <span class="sc">+</span> all <span class="sc">+</span> <span class="fu">tt</span>(tanc500),</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, rel != 0) ~ tt(tgvhd) + I(age/10) + 
    bmonly + all + tt(tanc500), data = bmt, ties = "breslow", 
    tt = function(x, t, ...) {
        dt &lt;- t - x
        cbind(tdcgvhd = 1 * (dt &gt; 0))
    })

                coef exp(coef) se(coef)      z        p
tt(tgvhd)   -0.18830   0.82837  0.13374 -1.408   0.1592
I(age/10)   -0.03934   0.96143  0.04452 -0.884   0.3770
bmonly      -0.12979   0.87828  0.13515 -0.960   0.3369
all          0.56216   1.75445  0.12968  4.335 1.46e-05
tt(tanc500) -2.13768   0.11793  1.07729 -1.984   0.0472

Likelihood ratio test=24.91  on 5 df, p=0.0001452
n= 2009, number of events= 259 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Death in remission</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 1</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,trm<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span> <span class="fu">tt</span>(tgvhd) <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> bmonly <span class="sc">+</span> all,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, trm != 0) ~ tt(tgvhd) + I(age/10) + 
    bmonly + all, data = bmt, ties = "breslow", tt = function(x, 
    t, ...) {
    dt &lt;- t - x
    cbind(tdcgvhd = 1 * (dt &gt; 0))
})

              coef exp(coef) se(coef)      z        p
tt(tgvhd)  1.04140   2.83318  0.09801 10.626  &lt; 2e-16
I(age/10)  0.26280   1.30056  0.03278  8.016 1.09e-15
bmonly    -0.08546   0.91809  0.09556 -0.894 0.371162
all        0.33359   1.39597  0.09817  3.398 0.000678

Likelihood ratio test=227  on 4 df, p=&lt; 2.2e-16
n= 2009, number of events= 505 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column 2</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel,trm<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">~</span>  <span class="fu">tt</span>(tgvhd) <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span> bmonly <span class="sc">+</span> all <span class="sc">+</span> <span class="fu">tt</span>(tanc500),</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> bmt, <span class="at">ties=</span><span class="st">"breslow"</span>,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">tt=</span><span class="cf">function</span>(x, t, ...) {</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>        dt <span class="ot">&lt;-</span> t<span class="sc">-</span>x</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">tdcgvhd=</span><span class="dv">1</span><span class="sc">*</span>(dt<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, trm != 0) ~ tt(tgvhd) + I(age/10) + 
    bmonly + all + tt(tanc500), data = bmt, ties = "breslow", 
    tt = function(x, t, ...) {
        dt &lt;- t - x
        cbind(tdcgvhd = 1 * (dt &gt; 0))
    })

                coef exp(coef) se(coef)      z        p
tt(tgvhd)    1.04016   2.82966  0.09854 10.556  &lt; 2e-16
I(age/10)    0.26289   1.30069  0.03288  7.996 1.28e-15
bmonly      -0.14047   0.86895  0.09627 -1.459 0.144550
all          0.33553   1.39868  0.09826  3.415 0.000639
tt(tanc500) -2.22822   0.10772  0.30523 -7.300 2.87e-13

Likelihood ratio test=275.1  on 5 df, p=&lt; 2.2e-16
n= 2009, number of events= 505 </code></pre>
</div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.12-sas_4d6f64f9bd0f122fbc64a25b09a35c0f">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> Relapse <span class="sc">**</span>; </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">1</span>;</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>);</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">rel</span>(<span class="dv">0</span>)<span class="ot">=</span>tdcgvhd age bmonly all<span class="sc">/</span>rl;</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>    tdcgvhd<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>tgvhd then tdcgvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">2</span>;</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>);</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">rel</span>(<span class="dv">0</span>)<span class="ot">=</span> tdcgvhd age bmonly all  tdcanc500<span class="sc">/</span>rl;</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>    tdcanc500<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> anc500<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>timeanc500 then tdcanc500<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>    tdcgvhd<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>tgvhd then tdcgvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> Death <span class="cf">in</span> remission <span class="sc">**</span>;</span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">1</span>; </span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>);</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span>tdcgvhd age bmonly all<span class="sc">/</span>rl;</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>    tdcgvhd<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>tgvhd then tdcgvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Column <span class="dv">2</span>;</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>);</span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">trm</span>(<span class="dv">0</span>)<span class="ot">=</span>tdcgvhd  age bmonly all tdcanc500 <span class="sc">/</span>rl;</span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true" tabindex="-1"></a>    tdcanc500<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> anc500<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>timeanc500 then tdcanc500<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-35"><a href="#cb204-35" aria-hidden="true" tabindex="-1"></a>    tdcgvhd<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb204-36"><a href="#cb204-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> and intxrel<span class="sc">&gt;</span>tgvhd then tdcgvhd<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb204-37"><a href="#cb204-37" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.14" class="level3">
<h3 class="anchored" data-anchor-id="table-3.14">Table 3.14</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.14-r_cb6d5de87a50bf3a5e654bd10d9bbb7b">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data set for analysis - double</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>bmtext <span class="ot">&lt;-</span> bmt <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">nygsource =</span> bmonly, </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nydisease =</span> all, </span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">age10 =</span> age<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">time =</span> <span class="fu">ifelse</span>(gvhd <span class="sc">==</span> <span class="dv">1</span>, tgvhd, intxrel), </span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">status =</span> <span class="fu">ifelse</span>(gvhd <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, trm),</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">entry =</span> <span class="dv">0</span>,</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>                         ) </span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>double1 <span class="ot">&lt;-</span> bmtext  <span class="sc">%&gt;%</span> </span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age1 =</span> age10, </span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">age2 =</span> <span class="dv">0</span>,</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">gsource1 =</span> nygsource, </span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">gsource2 =</span> <span class="dv">0</span>,</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">disease1 =</span> nydisease,</span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">disease2 =</span> <span class="dv">0</span>, </span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">stratum =</span> <span class="dv">1</span>)</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a>double2 <span class="ot">&lt;-</span> bmtext <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gvhd <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> intxrel, </span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">status =</span> trm,  </span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">entry =</span> tgvhd,</span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">age1 =</span> <span class="dv">0</span>, </span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">age2 =</span> age10,</span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">gsource1 =</span> <span class="dv">0</span>, </span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">gsource2 =</span> nygsource,</span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">disease1 =</span> <span class="dv">0</span>,</span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">disease2 =</span> nydisease, </span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">stratum =</span> <span class="dv">2</span>)</span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true" tabindex="-1"></a>doubledod <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(double1, double2))</span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-35"><a href="#cb205-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Row 1</span></span>
<span id="cb205-36"><a href="#cb205-36" aria-hidden="true" tabindex="-1"></a>r1<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entry, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> <span class="fu">strata</span>(stratum) <span class="sc">+</span> disease1 <span class="sc">+</span> disease2 <span class="sc">+</span> age1 <span class="sc">+</span> age2, </span>
<span id="cb205-37"><a href="#cb205-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> doubledod, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb205-38"><a href="#cb205-38" aria-hidden="true" tabindex="-1"></a>r1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entry, time, status != 0) ~ strata(stratum) + 
    disease1 + disease2 + age1 + age2, data = doubledod, ties = "breslow")

            coef exp(coef) se(coef)     z        p
disease1 0.26705   1.30610  0.15893 1.680  0.09290
disease2 0.36025   1.43369  0.12492 2.884  0.00393
age1     0.25561   1.29125  0.04791 5.336 9.53e-08
age2     0.28675   1.33209  0.04083 7.023 2.17e-12

Likelihood ratio test=82.11  on 4 df, p=&lt; 2.2e-16
n= 2983, number of events= 505 
   (2 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row 2</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>doubledod<span class="sc">$</span>type <span class="ot">&lt;-</span> doubledod<span class="sc">$</span>stratum <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entry, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> disease1 <span class="sc">+</span> disease2 <span class="sc">+</span> age1 <span class="sc">+</span> age2 <span class="sc">+</span> type, </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> doubledod, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entry, time, status != 0) ~ disease1 + disease2 + 
    age1 + age2 + type, data = doubledod, ties = "breslow")

            coef exp(coef) se(coef)     z        p
disease1 0.26172   1.29916  0.15877 1.648  0.09926
disease2 0.37891   1.46069  0.12478 3.037  0.00239
age1     0.24601   1.27891  0.04754 5.175 2.28e-07
age2     0.29228   1.33948  0.04101 7.128 1.02e-12
type     0.84247   2.32210  0.26891 3.133  0.00173

Likelihood ratio test=226.9  on 5 df, p=&lt; 2.2e-16
n= 2983, number of events= 505 
   (2 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>r2t<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entry, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> disease1 <span class="sc">+</span> disease2 <span class="sc">+</span> age1 <span class="sc">+</span> age2 <span class="sc">+</span> type</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>           <span class="sc">+</span><span class="fu">tt</span>(type), </span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> doubledod, <span class="at">ties =</span> <span class="st">"breslow"</span>,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">tt =</span> <span class="cf">function</span>(x,t, ...){</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>             gvhdt <span class="ot">=</span> x<span class="sc">*</span><span class="fu">log</span>(t)</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>           })</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="co"># In-text: LRT proportionality</span></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(r2, r2t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(entry, time, status != 0) ~ disease1 + disease2 + age1 + 
    age2 + type
Model 2: Surv(entry, time, status != 0) ~ disease1 + disease2 + age1 + 
    age2 + type + tt(type)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   5 -3542.8                     
2   6 -3541.8  1 2.0768     0.1496</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row 3</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>r3<span class="ot">&lt;-</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(entry, time, status <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> nydisease <span class="sc">+</span> age10 <span class="sc">+</span> type, </span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> doubledod, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>r3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(entry, time, status != 0) ~ nydisease + 
    age10 + type, data = doubledod, ties = "breslow")

             coef exp(coef) se(coef)      z        p
nydisease 0.33159   1.39318  0.09808  3.381 0.000723
age10     0.27230   1.31298  0.03103  8.774  &lt; 2e-16
type      1.04934   2.85577  0.09758 10.754  &lt; 2e-16

Likelihood ratio test=226.2  on 3 df, p=&lt; 2.2e-16
n= 2983, number of events= 505 
   (2 observations deleted due to missingness)</code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In-text: LRT common coefficients</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(r3,r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Surv(entry, time, status != 0) ~ nydisease + age10 + type
Model 2: Surv(entry, time, status != 0) ~ disease1 + disease2 + age1 + 
    age2 + type
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   3 -3543.2                     
2   5 -3542.8  2 0.7389     0.6911</code></pre>
</div>
</div>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.14-sas_a632495a0fb92ab5eea33bc88b56a3c6">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Make <span class="st">"double"</span> data set; </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>data doubledod; </span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    set bmt; </span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>    nygsource<span class="ot">=</span>bmonly; </span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    nydisease<span class="ot">=</span>all; </span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    age10<span class="ot">=</span>age<span class="sc">/</span><span class="dv">10</span>;</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    time<span class="ot">=</span>intxrel; </span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    status<span class="ot">=</span>trm; </span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    entry<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> then do; </span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>        time<span class="ot">=</span>tgvhd; </span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>        status<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>    age1<span class="ot">=</span>age10; </span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>    age2<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>    gsource1<span class="ot">=</span>nygsource; </span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>    gsource2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>    disease1<span class="ot">=</span>nydisease; </span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>    disease2<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>    stratum<span class="ot">=</span><span class="dv">1</span>; </span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    output;</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gvhd<span class="ot">=</span><span class="dv">1</span> then do;</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>        time<span class="ot">=</span>intxrel; </span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>        status<span class="ot">=</span>trm; </span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>        entry<span class="ot">=</span>tgvhd;</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a>        age1<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>        age2<span class="ot">=</span>age10; </span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a>        gsource1<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a>        gsource2<span class="ot">=</span>nygsource;</span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a>        disease1<span class="ot">=</span><span class="dv">0</span>; </span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a>        disease2<span class="ot">=</span>nydisease; </span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>        stratum<span class="ot">=</span><span class="dv">2</span>; </span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>        output; </span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>    end;</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Row <span class="dv">1</span>; </span>
<span id="cb215-40"><a href="#cb215-40" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>doubledod; </span>
<span id="cb215-41"><a href="#cb215-41" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>disease1 disease2 </span>
<span id="cb215-42"><a href="#cb215-42" aria-hidden="true" tabindex="-1"></a>    age1 age2 <span class="sc">/</span>entry<span class="ot">=</span>entry <span class="fu">type3</span>(lr);</span>
<span id="cb215-43"><a href="#cb215-43" aria-hidden="true" tabindex="-1"></a>    strata stratum;</span>
<span id="cb215-44"><a href="#cb215-44" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb215-45"><a href="#cb215-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-46"><a href="#cb215-46" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Row <span class="dv">2</span>; </span>
<span id="cb215-47"><a href="#cb215-47" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>doubledod; </span>
<span id="cb215-48"><a href="#cb215-48" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>disease1 disease2 </span>
<span id="cb215-49"><a href="#cb215-49" aria-hidden="true" tabindex="-1"></a>    age1 age2 type <span class="sc">/</span>entry<span class="ot">=</span>entry <span class="fu">type3</span>(lr);</span>
<span id="cb215-50"><a href="#cb215-50" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>stratum<span class="dv">-1</span>;</span>
<span id="cb215-51"><a href="#cb215-51" aria-hidden="true" tabindex="-1"></a>    test age1<span class="ot">=</span>age2, disease1<span class="ot">=</span>disease2; <span class="sc">/</span><span class="er">*</span> Wald test instead of LRT <span class="sc">*</span><span class="er">/</span></span>
<span id="cb215-52"><a href="#cb215-52" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb215-53"><a href="#cb215-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-54"><a href="#cb215-54" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> In<span class="sc">-</span>text<span class="sc">:</span> LRT proportionality variable <span class="st">'typelogt'</span>;</span>
<span id="cb215-55"><a href="#cb215-55" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>doubledod; </span>
<span id="cb215-56"><a href="#cb215-56" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>disease1 disease2 </span>
<span id="cb215-57"><a href="#cb215-57" aria-hidden="true" tabindex="-1"></a>    age1 age2 type typelogt  <span class="sc">/</span>entry<span class="ot">=</span>entry <span class="fu">type3</span>(lr);</span>
<span id="cb215-58"><a href="#cb215-58" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>stratum<span class="dv">-1</span>;</span>
<span id="cb215-59"><a href="#cb215-59" aria-hidden="true" tabindex="-1"></a>    typelogt<span class="ot">=</span>type<span class="sc">*</span><span class="fu">log</span>(time);</span>
<span id="cb215-60"><a href="#cb215-60" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb215-61"><a href="#cb215-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-62"><a href="#cb215-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-63"><a href="#cb215-63" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Row <span class="dv">3</span>; </span>
<span id="cb215-64"><a href="#cb215-64" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>doubledod; </span>
<span id="cb215-65"><a href="#cb215-65" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">stratum</span> (<span class="at">ref=</span><span class="st">'1'</span>) <span class="fu">nydisease</span> (<span class="at">ref=</span><span class="st">'0'</span>);</span>
<span id="cb215-66"><a href="#cb215-66" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>nydisease age10 type <span class="sc">/</span>entry<span class="ot">=</span>entry <span class="fu">type3</span>(lr);</span>
<span id="cb215-67"><a href="#cb215-67" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>stratum<span class="dv">-1</span>;</span>
<span id="cb215-68"><a href="#cb215-68" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="figure-3.10" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.10">Figure 3.10</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.10-r_6b46595046c4900e7195881afa868106">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract cumulative hazard from r1 </span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>survr1 <span class="ot">&lt;-</span> <span class="fu">basehaz</span>(r1, <span class="at">center =</span> F)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>pcumhaz <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cumhaz =</span> survr1<span class="sc">$</span>hazard, </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">time =</span> survr1<span class="sc">$</span>time, </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">strata =</span> survr1<span class="sc">$</span>strata) </span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Figure 3.10</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> cumhaz, <span class="at">linetype =</span> strata), <span class="at">data =</span> pcumhaz) <span class="sc">+</span> </span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time since bone marrow transplantation (months)"</span>) <span class="sc">+</span> </span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cumulative hazard"</span>) <span class="sc">+</span> </span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>)), </span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">156</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">156</span>, <span class="at">by =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Stratum"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)) <span class="sc">+</span> </span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>  theme_general <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>fig3<span class="fl">.10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Ch3_files/figure-html/figure-3.10-r-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell" data-hash="Ch3_cache/html/figure-3.10-sas_7677215235c964411bcd7d2d4430201a">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>data covar; </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>    input disease1 disease2 age1 age2; </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>    datalines; </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>; </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>doubledod; </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>    model time<span class="sc">*</span><span class="fu">status</span>(<span class="dv">0</span>)<span class="ot">=</span>disease1 disease2 age1 age2 <span class="sc">/</span> entry<span class="ot">=</span>entry ;</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>    strata stratum;</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>    baseline out<span class="ot">=</span>trm cumhaz<span class="ot">=</span>breslow covariates<span class="ot">=</span>covar;</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>proc gplot data<span class="ot">=</span>trm;</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>    plot breslow<span class="sc">*</span>time<span class="ot">=</span>stratum<span class="sc">/</span>haxis<span class="ot">=</span>axis1 vaxis<span class="ot">=</span>axis2;</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>    axis1 order<span class="ot">=</span><span class="dv">0</span> to <span class="dv">156</span> by <span class="dv">12</span> minor<span class="ot">=</span>none</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="st">'Time since bone marrow transplantation (months)'</span>);</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>    axis2 order<span class="ot">=</span><span class="dv">0</span> to <span class="fl">0.3</span> by <span class="fl">0.05</span> minor<span class="ot">=</span>none</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>        label<span class="ot">=</span>(<span class="at">a=</span><span class="dv">90</span> <span class="st">'Cumulative hazard of death in remission'</span>);</span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>    symbol1  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>blue;</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>    symbol2  v<span class="ot">=</span>none i<span class="ot">=</span>stepjl c<span class="ot">=</span>red;;</span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>quit;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="table-3.15-1" class="level3">
<h3 class="anchored" data-anchor-id="table-3.15-1">Table 3.15</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.15-r_90af78ac6817b591778f53df44ad8490">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel, state0 <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> bmonly <span class="sc">+</span> all <span class="sc">+</span> age </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">frailty.gamma</span>(team, <span class="at">eps =</span> <span class="fl">1e-09</span>), <span class="at">data =</span> bmt, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, state0 != 0) ~ bmonly + all + age + 
    frailty.gamma(team, eps = 1e-09), data = bmt, ties = "breslow")

                              coef se(coef)      se2    Chisq DF       p
bmonly                    -0.17512  0.08704  0.08178  4.04856  1  0.0442
all                        0.47196  0.07965  0.07829 35.11425  1 3.1e-09
age                        0.01873  0.00275  0.00263 46.44972  1 9.4e-12
frailty.gamma(team, eps =                            84.11745 51  0.0024

Iterations: 9 outer, 43 Newton-Raphson
     Variance of random effect= 0.117   I-likelihood = -5495.9 
Degrees of freedom for terms=  0.9  1.0  0.9 51.0 
Likelihood ratio test=214  on 53.7 df, p=&lt;2e-16
n= 2009, number of events= 764 </code></pre>
</div>
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel, state0 <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> bmonly <span class="sc">+</span> all <span class="sc">+</span> age</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">frailty.gaussian</span>(team, <span class="at">eps =</span> <span class="fl">1e-09</span>, <span class="at">sparse=</span>F), <span class="at">data =</span> bmt, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, state0 != 0) ~ bmonly + all + age + 
    frailty.gaussian(team, eps = 1e-09, sparse = F), data = bmt, 
    ties = "breslow")

                              coef se(coef)      se2    Chisq   DF       p
bmonly                    -0.17683  0.08755  0.08208  4.08010  1.0  0.0434
all                        0.47435  0.07989  0.07844 35.25576  1.0 2.9e-09
age                        0.01891  0.00278  0.00265 46.42018  1.0 9.5e-12
frailty.gaussian(team, ep                            90.71464 55.1  0.0018

Iterations: 8 outer, 22 Newton-Raphson
     Variance of random effect= 0.139 
Degrees of freedom for terms=  0.9  1.0  0.9 55.2 
Likelihood ratio test=695  on 57.9 df, p=&lt;2e-16
n= 2009, number of events= 764 </code></pre>
</div>
</div>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell" data-hash="Ch3_cache/html/table-3.15-sas_f31c499249dac677cc9e8219c1f24af5">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Gamma; </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>) team;</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">state0</span>(<span class="dv">0</span>)<span class="ot">=</span>bmonly all age<span class="sc">/</span>rl;</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    random team<span class="sc">/</span>dist<span class="ot">=</span>gamma;</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> Log<span class="sc">-</span>normal; </span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>) team;</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">state0</span>(<span class="dv">0</span>)<span class="ot">=</span>bmonly all age<span class="sc">/</span>rl;</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>    random team;</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="in-text-stratified-cox-model-by-center" class="level3">
<h3 class="anchored" data-anchor-id="in-text-stratified-cox-model-by-center">In-text: stratified Cox model by center</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false">SAS</a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-stratified-r_8b9c8d1a8df4ff206b0985ec0b411b7c">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(intxrel, state0 <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">~</span> bmonly <span class="sc">+</span> all <span class="sc">+</span> age </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> <span class="fu">strata</span>(team), <span class="at">data =</span> bmt, <span class="at">ties =</span> <span class="st">"breslow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(intxrel, state0 != 0) ~ bmonly + all + age + 
    strata(team), data = bmt, ties = "breslow")

            coef exp(coef)  se(coef)      z        p
bmonly -0.196894  0.821277  0.114392 -1.721   0.0852
all     0.470582  1.600926  0.090822  5.181 2.20e-07
age     0.020946  1.021167  0.003539  5.918 3.26e-09

Likelihood ratio test=61.1  on 3 df, p=3.424e-13
n= 2009, number of events= 764 </code></pre>
</div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell" data-hash="Ch3_cache/html/in-text-stratified-sas_f9ec1118b1901a41757360ad08d3f1f2">
<details>
<summary>Code show/hide</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>proc phreg data<span class="ot">=</span>bmt;</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">bmonly</span>(<span class="at">ref=</span><span class="st">"0"</span>) <span class="fu">all</span>(<span class="at">ref=</span><span class="st">"0"</span>) team;</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>    model intxrel<span class="sc">*</span><span class="fu">state0</span>(<span class="dv">0</span>)<span class="ot">=</span>bmonly all age<span class="sc">/</span>rl;</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>    strata team;</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>run;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intuition for intensity models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intuition for marginal models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Models for Multi-State Survival Data: Rates, Risks, and Pseudo-Values</div>   
    <div class="nav-footer-right">Built with <a href="https://quarto.org/">Quarto</a>, R v4.3.1, and SAS 15.1</div>
  </div>
</footer>



</body></html>