theme(text = element_text(size = 20),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
legend.position = "bottom",
legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(2,"line")
)
#------------------------------------------------------------------#
# Figure 2.1
#------------------------------------------------------------------#
# Nelson Aalen estimate by treatment
library(survival)
nafit <- survfit(Surv(days, status != 0) ~ tment, data = pbc3)
# Collect data for plot
nadata <- data.frame(cumhaz = nafit$cumhaz, time = nafit$time,
tment = c(rep(names(nafit$strata)[1], nafit$strata[1]),
rep(names(nafit$strata)[2], nafit$strata[2])))
# Create Figure 2.1
library(ggplot2)
fig2.1 <- ggplot(aes(x = time / 365.25, y = cumhaz, linetype = tment), data = nadata) +
geom_step(size = 1) +
scale_linetype_discrete("Treatment", labels = c("Placebo", "CyA")) +
xlab("Time since randomization (years)") +
ylab("Cumulative hazard") +
scale_x_continuous(expand = expansion(mult = c(0.001, 0.05)),
limits = c(0, 6), breaks = seq(0, 6, 1))  +
scale_y_continuous(expand = expansion(mult = c(0.005, 0.05))) +
theme_general
fig2.1
#------------------------------------------------------------------#
# In-text: Nelson-Aalen estimates at 2 years
#------------------------------------------------------------------#
tail(subset(nadata, nadata$time <= 2*365.25 & nadata$tment == "tment=0"),1)
tail(subset(nadata, nadata$time <= 2*365.25 & nadata$tment == "tment=1"),1)
#------------------------------------------------------------------#
# Table 2.1
#------------------------------------------------------------------#
# Data for Table 2.1
cuts <- c(0, 2, 4) * 365.25
# Make the data ready using survSplit from survival package
library(survival)
pbc3mult <- as.data.frame(survSplit(Surv(days, fail) ~ ., pbc3,
cut = cuts[-1],
episode = "timegroup"))
pbc3mult$risktime <- pbc3mult$days - cuts[pbc3mult$timegroup]
pbc3mult$timegroup <- as.factor(pbc3mult$timegroup)
library(dplyr)
pcwdata <- pbc3mult %>%
group_by(tment, timegroup) %>%
summarise(fail = sum(fail), risktime = sum(days - cuts[timegroup]))
pcwdata$risktimeyrs <- pcwdata$risktime/365.25
pcwdata$hazard <- 36525*pcwdata$fail/pcwdata$risktime
pcwdata$SD <- 36525*sqrt(pcwdata$fail)/pcwdata$risktime
data.frame(pcwdata)
#------------------------------------------------------------------#
# Figure 2.2
#------------------------------------------------------------------#
# Rates + cuts from Table 2.1
rateCyA <- c(8.1,13.1,9.6)
ratePbo <- c(9.4,12.5,8.5)
pcwtime <- c(0,2,4,5)
# Collect data
plotdata <- data.frame(rates = c(rateCyA, ratePbo),
tment = c(rep("CyA", length(rateCyA)),
rep("Placebo", length(ratePbo))),
times_s = rep(pcwtime[-4], 2),
times = rep(pcwtime[-1], 2))
# Create Figure 2.2
fig2.2 <- ggplot(aes(x = time, y = rates, linetype = tment), data = plotdata) +
geom_segment(aes(x = times_s, y = rates, xend = times, yend = rates), size = 1) +
scale_linetype_discrete("Treatment", labels = c("Placebo", "CyA"))  +
xlab("Time since randomization (years)") +
ylab("Estimated hazard function (per 100 years)") +
scale_x_continuous(expand = expansion(mult = c(0.001, 0.05)),
limits = c(0, 5),
breaks = seq(0, 5, 1))  +
scale_y_continuous(expand = expansion(mult = c(0.005, 0.05)),
limits = c(0,14), breaks = seq(0, 14, 2)) +
theme_general
fig2.2
#------------------------------------------------------------------#
# In-text: LRT test using piece-wise exponential model
#------------------------------------------------------------------#
library(stats)
poisfull <- glm(fail ~ - 1 + tment + timegroup + tment:timegroup +
offset(log(risktime/36525)), data = pbc3mult, family = poisson)
poisred <- glm(fail ~ - 1 + timegroup +
offset(log(risktime/36525)), data = pbc3mult, family = poisson)
anova(poisred,poisfull,test="LRT")
# or
library(lmtest)
lrtest(poisred,poisfull)
#------------------------------------------------------------------#
# In-text: Logrank test and p-value
#------------------------------------------------------------------#
library(survival)
lr<-survdiff(Surv(days, status != 0) ~ tment, data = pbc3)
c(lr$chisq,lr$pvalue)
#------------------------------------------------------------------#
# Figure 2.3
#------------------------------------------------------------------#
# NA data from figure 2.1 model fit
tment1 <- subset(nadata, tment == "tment=1")
# Estimated hazard per time group
pcwdata$hazard_timegroup <- pcwdata$fail / pcwdata$risktime
# Add a numeric version of the treatment to the NA estimates
nadata$tmentnum <- ifelse(nadata$tment == "tment=1", 1, 0)
# Add piecewise constant hazard to data
nadata$pwch <- NULL
# Between time 0 and 2
nadata$pwch[nadata$time <= 2 * 365.25] <- nadata$time[nadata$time <= 2 * 365.25] *
(pcwdata$hazard_timegroup[1] * (1-nadata$tmentnum[nadata$time <= 2 * 365.25]) +
pcwdata$hazard_timegroup[4] * (nadata$tmentnum[nadata$time <= 2 * 365.25]))
# Between time 2 and 4
nadata$pwch[nadata$time > 2 * 365.25 & nadata$time <= 4* 365.25 ] <- 2 * 365.25 *
(pcwdata$hazard_timegroup[1] * (1-nadata$tmentnum[nadata$time > 2 * 365.25 & nadata$time <= 4 * 365.25]) +
pcwdata$hazard_timegroup[4] * (nadata$tmentnum[nadata$time > 2 * 365.25 & nadata$time <= 4 * 365.25])) +
(nadata$time[nadata$time > 2 * 365.25 & nadata$time <= 4 * 365.25] - 2 * 365.25) *
(pcwdata$hazard_timegroup[2] * (1-nadata$tmentnum[nadata$time > 2 * 365.25 & nadata$time <= 4 * 365.25]) +
pcwdata$hazard_timegroup[5] * (nadata$tmentnum[nadata$time > 2 * 365.25 & nadata$time <= 4 * 365.25]))
# After time 4
nadata$pwch[nadata$time > 4 * 365.25] <- 2 * 365.25 *
(pcwdata$hazard_timegroup[1] * (1-nadata$tmentnum[nadata$time > 4 * 365.25]) +
pcwdata$hazard_timegroup[4] * (nadata$tmentnum[nadata$time > 4 * 365.25])) +
2 * 365.25 *
(pcwdata$hazard_timegroup[2] * (1-nadata$tmentnum[nadata$time > 4 * 365.25]) +
pcwdata$hazard_timegroup[5] * (nadata$tmentnum[nadata$time > 4 * 365.25])) +
(nadata$time[nadata$time > 4 * 365.25] - 4 * 365.25) *
(pcwdata$hazard_timegroup[3] * (1-nadata$tmentnum[nadata$time > 4 * 365.25]) +
pcwdata$hazard_timegroup[6] * (nadata$tmentnum[nadata$time > 4 * 365.25]))
# Reformat for plot
piecepdata <- data.frame(cumhaz = c(nadata$cumhaz, nadata$pwch),
time = rep(nadata$time, 2),
tmentnum = rep(nadata$tmentnum, 2),
type = c(rep("Nelson-Aalen", length(nadata$time)),
rep("Piece-wise exponential", length(nadata$time))))
# Only for treatment 1
piecepdata1 <- subset(piecepdata, tmentnum == 1)
# Create Figure 2.3
fig2.3 <- ggplot(aes(x = time / 365.25, y = cumhaz, linetype = type),
data = subset(piecepdata1, type == "Nelson-Aalen")) +
geom_step(size = 1) +
geom_line(aes(x = time / 365.25, y = cumhaz, linetype = type), size = 1,
data = subset(piecepdata1, type == "Piece-wise exponential")) +
labs(linetype = "Type") +
xlab("Time since randomization (years)") +
ylab("Cumulative hazard") +
scale_x_continuous(expand = expansion(mult = c(0.001, 0.05)),
limits = c(0, 6),
breaks = seq(0, 6, 1))  +
scale_y_continuous(expand = expansion(mult = c(0.005, 0.05))) +
theme_general+
theme(legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(2,"line"))
fig2.3
#------------------------------------------------------------------#
# In-text: Cox model
#------------------------------------------------------------------#
# Fit a Cox model using the pbc3 data with treatment as a covariate
library(survival)
coxfit <- coxph(Surv(days, status != 0) ~ tment, data = pbc3, method = "breslow")
summary(coxfit)
#------------------------------------------------------------------#
# Figure 2.5
#------------------------------------------------------------------#
# Extract cumulative baseline hazard
coxcumhaz <- basehaz(coxfit, centered = FALSE)
# Collect data for plot (Breslow estimate)
coxdata <- data.frame(cumhaz = coxcumhaz$hazard,
time = coxcumhaz$time,
tment = rep("0", nrow(coxcumhaz)),
type = rep("Breslow estimate", nrow(coxcumhaz)))
# Create Figure 2.5
fig2.5 <- ggplot(aes(x = time / 365.25, y = cumhaz, linetype = tment), data = coxdata) +
geom_step(size = 1) +
xlab("Time since randomization (years)") +
ylab("Cumulative baseline hazard") +
scale_linetype_discrete("Treatment", labels = c("Placebo")) +
scale_x_continuous(expand = expansion(mult = c(0.001, 0.05)),
limits = c(0, 6),
breaks = seq(0, 6, 1)) +
scale_y_continuous(expand = expansion(mult = c(0.005, 0.05))) +
theme_general+theme(legend.position = "none")
fig2.5
#------------------------------------------------------------------#
# Table 2.3
#------------------------------------------------------------------#
# Average covariate values of albumin and bilirubin per treatment
library(dplyr)
tabledata <- pbc3 %>%
group_by(tment, tment_char) %>%
summarise(n = sum(id != 0),
average_albumin = mean(alb, na.rm = TRUE), # NOTE: Removes missing observations from mean computation
average_bilirubin = mean(bili, na.rm = TRUE),
)
data.frame(tabledata)
#------------------------------------------------------------------#
# Table 2.4
#------------------------------------------------------------------#
# Cox model with treatment, albumin and bilirubin as covariates
library(survival)
coxfit <- coxph(Surv(days, status != 0) ~ tment + alb + bili,
data = pbc3)
summary(coxfit)
#------------------------------------------------------------------#
# In-text: Poisson model with treatment
#------------------------------------------------------------------#
library(stats)
library(broom) # For using tidy() function
poism <- glm(fail ~ tment + timegroup-1 +
offset(log(risktime/365.25)), data = pbc3mult,family = poisson)
tidy(poism, exponentiate = T, conf.int = T)
#------------------------------------------------------------------#
# Table 2.5
#------------------------------------------------------------------#
# Poisson model with treatment, albumin and bilirubin as covariates
poismod_t25 <- glm(fail ~ tment + alb + bili+ timegroup-1 +
offset(log(risktime/365.25)), data = pbc3mult, family = poisson)
tidy(poismod_t25)
#------------------------------------------------------------------#
# Table 2.6
#------------------------------------------------------------------#
# Add transformations of covariates
pbc3$albnorm <- with(pbc3, (alb-35)*(alb>35))
pbc3$bilihigh <- with(pbc3, (bili-17.1)*(bili>17.1))
pbc3$bilitoohigh <- with(pbc3, (bili-34.2)*(bili>34.2))
pbc3$bilimuchtoohigh <- with(pbc3, (bili-51.3)*(bili>51.3))
pbc3$log2bili <- with(pbc3, log2(bili))
pbc3$log2bili2 <- with(pbc3, log2bili*log2bili)
pbc3$logbilihigh <- with(pbc3, (log2bili-log2(17.1))*(bili>17.1))
pbc3$logbilitoohigh <- with(pbc3, (log2bili-log2(34.2))*(bili>34.2))
pbc3$logbilimuchtoohigh <- with(pbc3, (log2bili-log2(51.3))*(bili>51.3))
#------------------------------------------------------------------#
# Table 2.6 Cox models
#------------------------------------------------------------------#
# Models for LR tests
library(lmtest)
base_coxmod <- coxph(Surv(days, status != 0) ~ tment + alb + bili,
eps = 1e-8, method = "breslow", data = pbc3)
base_coxmod_log <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
# Splines Cox 1
coxmod_t26_l1 <- coxph(Surv(days, status != 0) ~ tment + alb + albnorm + bili,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_l1)
lrtest(coxmod_t26_l1, base_coxmod)
# Quadratic Cox 1
coxmod_t26_q1 <- coxph(Surv(days, status != 0) ~ tment + alb + I(alb*alb) + bili ,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_q1)
lrtest(coxmod_t26_q1, base_coxmod)
# Splines Cox 2
coxmod_t26_l2 <- coxph(Surv(days, status != 0) ~ tment + alb +
bili + bilihigh + bilitoohigh + bilimuchtoohigh,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_l2)
lrtest(coxmod_t26_l2, base_coxmod)
# Quadratic Cox 2
coxmod_t26_q2 <- coxph(Surv(days, status != 0) ~ tment + alb + bili + I(bili*bili),
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_q2)
lrtest(coxmod_t26_q2, base_coxmod)
# Splines Cox 3
coxmod_t26_l3 <- coxph(Surv(days, status != 0) ~ tment + alb +
log2bili + logbilihigh + logbilitoohigh + logbilimuchtoohigh,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_l3)
lrtest(coxmod_t26_l3, base_coxmod_log)
# Quadratic Cox 3
coxmod_t26_q3 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + log2bili2,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t26_q3)
lrtest(coxmod_t26_q3, base_coxmod_log)
#------------------------------------------------------------------#
# Table 2.6 Poisson models
#------------------------------------------------------------------#
# Make the data ready for Poisson models using survSplit from survival package
library(survival)
pbc3mult <- as.data.frame(survSplit(Surv(days, fail) ~ ., pbc3,
cut = cuts[-1],
episode = "timegroup"))
pbc3mult$risktime <- pbc3mult$days - cuts[pbc3mult$timegroup]
pbc3mult$timegroup <- as.factor(pbc3mult$timegroup)
# Models for LR test
base_poismod <- glm(fail ~ timegroup + tment + alb + bili +
offset(log(risktime)), data = pbc3mult, family = poisson)
base_poismod_log <- glm(fail ~ timegroup + tment + alb + log2bili +
offset(log(risktime)), data = pbc3mult, family = poisson)
# Splines Poisson 1
poismod_t26_l1 <- glm(fail ~ timegroup + tment + alb + albnorm + bili +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_l1)
lrtest(poismod_t26_l1, base_poismod)
# Quadratic Poisson 1
poismod_t26_q1 <- glm(fail ~ timegroup + tment + alb + I(alb*alb) + bili +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_q1)
lrtest(poismod_t26_q1, base_poismod)
# Splines Poisson 2
poismod_t26_l2 <- glm(fail ~ timegroup + tment + alb +
bili + bilihigh + bilitoohigh + bilimuchtoohigh +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_l2)
lrtest(poismod_t26_l2, base_poismod)
# Quadratic Poisson 2
poismod_t26_q2 <- glm(fail ~ timegroup + tment + alb + bili + I(bili*bili) +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_q2)
lrtest(poismod_t26_q2, base_poismod)
# Splines Poisson 3
poismod_t26_l3 <- glm(fail ~ timegroup + tment + alb +
log2bili + logbilihigh + logbilitoohigh + logbilimuchtoohigh +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_l3)
lrtest(poismod_t26_l3, base_poismod_log)
# Quadratic Poisson 3
poismod_t26_q3 <- glm(fail ~ timegroup + tment + alb + log2bili + log2bili2 +
offset(log(risktime)), data = pbc3mult, family = poisson)
tidy(poismod_t26_q3)
lrtest(poismod_t26_q3, base_poismod_log)
pbc3mult$timegroup <- relevel(as.factor(pbc3mult$timegroup), ref = "3")
pbc3mult$tment_char <- as.factor(pbc3mult$tment_char)
pbc3mult$tment_char <- relevel(pbc3mult$tment_char, ref = "Placebo")
base_poismod <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb + bili,
data = pbc3mult,
family = poisson)
poismod_t26_l1 <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb + bili + albnorm,
data = pbc3mult,
family = poisson)
poismod_t26_l3 <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb +
bili + bilihigh + bilitoohigh + bilimuchtoohigh,
data = pbc3mult,
family = poisson)
# Make a dataset with linear predictor information
lin2 <- pbc3
lin2$lp1 <- with(pbc3, 1.6076-0.1123*alb)
lin2$lp2 <- with(pbc3, 0.7828-0.0864*alb-0.0474*albnorm)
lin2$lp3 <- with(pbc3, 1.6076+0.0085*bili-38.7*0.1123)
lin2$lp4 <- with(pbc3, -0.5534+0.0617*bili-0.0168*bilihigh+0.0027*bilitoohigh
-0.0428*bilimuchtoohigh-0.0865*38.7)
lin2row <- data.frame(effect = c(rep("Linear effect", nrow(lin2)),
rep("Effect as linear spline", nrow(lin2))),
lp = c(lin2$lp1, lin2$lp2),
alb = c(lin2$alb, lin2$alb))
library(ggplot2)
fig2.6 <- ggplot(aes(x = alb, y = lp, linetype = effect), data = lin2row) +
geom_line(size = 1) +
xlab("Albumin") +
ylab("Linear predictor") +
scale_linetype_discrete("Effect") +
scale_x_continuous(expand = expansion(mult = c(0.03, 0.05))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.05))) +
theme_general
fig2.6
# bilirubin and the two last linear predictors
lin2row2 <- data.frame(effect = c(rep("Linear effect", nrow(lin2)),
rep("Effect as linear spline", nrow(lin2))),
lp = c(lin2$lp3, lin2$lp4),
bili = c(lin2$bili, lin2$bili))
require(ggplot2)
fig2.7 <- ggplot(aes(x = bili, y = lp, linetype = effect), data = lin2row2) +
geom_line(size = 1) +
xlab("Bilirubin") +
ylab("Linear predictor") +
scale_linetype_discrete("Effect") +
scale_x_continuous(expand = expansion(mult = c(0.03, 0.05))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.05))) +
theme_general +
theme(legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(2,"line"))
fig2.7
fig2.7 <- ggplot(aes(x = bili, y = lp, linetype = effect), data = lin2row2) +
geom_line(size = 1) +
xlab("Bilirubin") +
ylab("Linear predictor") +
scale_linetype_discrete("Effect") +
scale_x_continuous(expand = expansion(mult = c(0.03, 0.05))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.05))) +
theme_general
fig2.7
# The below linear predictors include estimates from the following models
base_poismod2_log <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb10 + log2bili,
data = pbc3mult, family = poisson)
base_poismod2_log <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb + log2bili,
data = pbc3mult, family = poisson)
poismod_t26_l3 <- glm(fail ~ offset(log(risktime)) + as.factor(timegroup) + tment_char + alb +
log2bili + logbilihigh + logbilitoohigh + logbilimuchtoohigh,
data = pbc3mult, family = poisson)
# Make a dataset with linear predictor information
log2 <- pbc3
log2$lp3 <- with(pbc3, -2.0162+0.6469*log2bili-38.7*0.087)
log2$lp4 <- with(pbc3, -0.6194+0.198*log2bili+0.8815*logbilihigh-0.2336*logbilitoohigh
-0.3139*logbilimuchtoohigh-0.0844*38.7)
log2row <- data.frame(effect = c(rep("Linear effect", nrow(log2)),
rep("Effect as linear spline", nrow(log2))),
lp = c(log2$lp3, log2$lp4),log2bili = c(log2$log2bili, log2$log2bili))
fig2.8 <- ggplot(aes(x = log2bili, y = lp, linetype = effect), data = log2row) +
geom_line(size = 1) +
xlab(expression(log[2] * "(bilirubin)")) +
ylab("Linear predictor") +
scale_linetype_discrete("Effect") +
scale_x_continuous(expand = expansion(mult = c(0.03, 0.05))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.05))) +
theme_general +
theme(legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(2,"line"))
fig2.8
fig2.8 <- ggplot(aes(x = log2bili, y = lp, linetype = effect), data = log2row) +
geom_line(size = 1) +
xlab(expression(log[2] * "(bilirubin)")) +
ylab("Linear predictor") +
scale_linetype_discrete("Effect") +
scale_x_continuous(expand = expansion(mult = c(0.03, 0.05))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.05))) +
theme_general
fig2.8
# Cox model
coxmod_t27 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t27)
# Poisson model
poismod_t27 <- glm(fail ~ tment + alb + log2bili + timegroup + offset(log(risktime)),
data = pbc3mult, family = poisson)
tidy(poismod_t27)
# Cox models
# Model for LR comparison
coxmod_t28_base <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
# Cox model 1
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_base <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
# Cox model 1
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
lrtest(coxmod_t28_1, coxmod_t28_base)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment +tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
lrtest(coxmod_t28_1, coxmod_t28_base)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ alb + log2bili + tment:alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_2 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_2)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment+ alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
# Model for LR comparison
coxmod_t28_base <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
# Cox model 1
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment+ alb + log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
lrtest(coxmod_t28_1, coxmod_t28_base)
# Cox model 2
coxmod_t28_2 <- coxph(Surv(days, status != 0) ~ tment + alb + log2bili + tment*log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_2)
lrtest(coxmod_t28_2, coxmod_t28_base)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + tment*alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + tment*alb + alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + tment + alb:tment,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + alb:tment,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + alb:tment + alb,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + alb:tment + alb + tment,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ log2bili + alb:tment,
eps = 1e-8, method = "breslow", data = pbc3)
tidy(coxmod_t28_1)
coxmod_t28_1 <- coxph(Surv(days, status != 0) ~ tment + alb(tment) + log2bili,
eps = 1e-8, method = "breslow", data = pbc3)
pbc3 <- data.frame(read.csv("data/pbc3.csv"))
coxph(Surv(days, status != 0) ~ tment + alb, data = pbc3)
pbc3 <- data.frame(read.csv("data/pbc3.csv"))
library(survival)
coxph(Surv(days, status != 0) ~ tment + alb, data = pbc3)
pbc3 <- read.csv("data/pbc3.csv")
coxph(Surv(days, status != 0) ~ tment + alb+ tment*alb, data = pbc3)
# Read data
pbc3 <- data.frame(read.csv("data/pbc3.csv"))
pbc3 <- data.frame(read.csv("data/pbc3.csv"))
pbc3 <- read.csv("data/pbc3.csv")
